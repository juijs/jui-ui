!function(a,b,c){var d={jquery:a},e={},f={},g=b.navigator,h={template:{evaluate:/<\!([\s\S]+?)\!>/g,interpolate:/<\!=([\s\S]+?)\!>/g,escape:/<\!-([\s\S]+?)\!>/g},logUrl:"tool/debug.html"},i=function(a,b){function c(b,c){var d=a[b];a[b]=a[c],a[c]=d}function d(b,d,f){var g=d,h=a[b];c(b,f);for(var i=d;f>i;i++)(e(a[i],h)||!e(h,a[i])&&i%2==1)&&(c(i,g),g++);return c(f,g),g}var e=null,a=b?a.slice(0):a;this.setCompare=function(a){e=a},this.run=function(b,c){var e=null;return"number"!=typeof b&&(b=0),"number"!=typeof c&&(c=a.length-1),c>b&&(e=b+Math.ceil(.5*(c-b)),newPivot=d(e,b,c),this.run(b,newPivot-1),this.run(newPivot+1,c)),a}},j=function(){this.isIndexDepth=function(a){return"string"==typeof a&&-1!=a.indexOf(".")?!0:!1},this.getIndexList=function(a){var b=[],c=""+a;if(1==c.length)b[0]=parseInt(a);else for(var d=c.split("."),e=0;e<d.length;e++)b[e]=parseInt(d[e]);return b},this.changeIndex=function(a,b,c){for(var d=this.getIndexList(c).length,e=this.getIndexList(a),f=this.getIndexList(b),g=0;d>g;g++)e.shift();return f.concat(e).join(".")},this.getNextIndex=function(a){var b=this.getIndexList(a),c=b.pop()+1;return b.push(c),b.join(".")},this.getParentIndex=function(a){if(!this.isIndexDepth(a))return null;var b=this.getIndexList(a);return 2==b.length?""+b[0]:b.length>2?(b.pop(),b.join(".")):void 0}},k={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=k._utf8_encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+k._keyStr.charAt(e)+k._keyStr.charAt(f)+k._keyStr.charAt(g)+k._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=k._keyStr.indexOf(a.charAt(j++)),f=k._keyStr.indexOf(a.charAt(j++)),g=k._keyStr.indexOf(a.charAt(j++)),h=k._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=k._utf8_decode(i)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b=String.fromCharCode(239)+String.fromCharCode(187)+String.fromCharCode(191),c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}},l=function(a,b,c){var d={},e={},f=Array.prototype,g=f.slice,i=f.forEach,j={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var k in j)j[j[k]]=k;var l=/\\|'|\r|\n|\t|\u2028|\u2029/g,m=/\\(\\|'|r|n|t|u2028|u2029)/g,n=/.^/,o=function(a){return a.replace(m,function(a,b){return j[b]})},p=d.each=d.forEach=function(a,b,c){if(null!=a)if(i&&a.forEach===i)a.forEach(b,c);else if(a.length===+a.length){for(var f=0,g=a.length;g>f;f++)if(f in a&&b.call(c,a[f],f,a)===e)return}else for(var h in a)if(d.has(a,h)&&b.call(c,a[h],h,a)===e)return};return d.has=function(a,b){return hasOwnProperty.call(a,b)},d.defaults=function(a){return p(g.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},d.template=function(a,b,c){c=d.defaults(c||{},h.template);var e="__p+='"+a.replace(l,function(a){return"\\"+j[a]}).replace(c.escape||n,function(a,b){return"'+\n_.escape("+o(b)+")+\n'"}).replace(c.interpolate||n,function(a,b){return"'+\n("+o(b)+")+\n'"}).replace(c.evaluate||n,function(a,b){return"';\n"+o(b)+"\n;__p+='"})+"';\n";c.variable||(e="with(obj||{}){\n"+e+"}\n"),e="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+e+"return __p;\n";var f=new Function(c.variable||"obj","_",e);if(b)return f(b,d);var g=function(a){return f.call(this,a,d)};return g.source="function("+(c.variable||"obj")+"){\n"+e+"}",g},d.template(a,b,c)},m=d["util.base"]={browser:{webkit:"WebkitAppearance"in document.documentElement.style?!0:!1,mozilla:"undefined"!=typeof b.mozInnerScreenX?!0:!1,msie:-1!=g.userAgent.indexOf("Trident")?!0:!1},isTouch:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(g.userAgent),scrollWidth:function(){var b=a(".jui").size()>0&&this.browser.webkit?!0:!1,c=a('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div></div>');a("body").append(c);var d=a("div",c).innerWidth();c.css("overflow-y","auto");var e=a("div",c).innerWidth();return a(c).remove(),b?10:d-e},inherit:function(a,b){this.typeCheck("function",a)&&this.typeCheck("function",b)&&(a.parent=b,a.prototype=new b,a.prototype.constructor=a,a.prototype.parent=a.prototype,a.prototype["super"]=function(a,b){return this.constructor.prototype[a].apply(this,b)})},extend:function(a,b,c){function d(a){return m.typeCheck("object",a)}if(this.typeCheck("object",a)||(a={}),!this.typeCheck("object",b))return a;for(var e in b)c===!0?d(a[e])?this.extend(a[e],b[e],c):this.typeCheck("undefined",a[e])&&(a[e]=b[e]):d(a[e])?this.extend(a[e],b[e],c):a[e]=b[e];return a},pxToInt:function(a){return"string"==typeof a&&-1!=a.indexOf("px")?parseInt(a.split("px").join("")):a},clone:function(b){var c=a.isArray(b)?[]:{};for(var d in b)this.typeCheck("object",b[d])?c[d]=this.clone(b[d]):c[d]=b[d];return c},deepClone:function(a,b){var c=null;if(b=b||{},this.typeCheck("array",a)){c=new Array(a.length);for(var d=0,e=a.length;e>d;d++)c[d]=this.deepClone(a[d],b)}else if(this.typeCheck("date",a))c=a;else if(this.typeCheck("object",a)){c={};for(var f in a)b[f]?c[f]=a[f]:c[f]=this.deepClone(a[f],b)}else c=a;return c},sort:function(a){return new i(a)},runtime:function(a,b){var c=(new Date).getTime();b();var d=(new Date).getTime();console.log(a+" : "+(d-c)+"ms")},template:function(a,b){return b?l(a,b):l(a)},resize:function(c,d){var e=function(){var a=0;return function(){clearTimeout(a),a=setTimeout(c,d)}}();a(b).resize(function(){e()})},index:function(){return new j},chunk:function(a,b){for(var c=[],d=0,e=a.length;e>d;)c.push(a.slice(d,d+=b));return c},typeCheck:function(a,b){function c(a,b){return"string"!=typeof a?!1:"string"==a?"string"==typeof b:"integer"==a?"number"==typeof b&&b%1==0:"float"==a?"number"==typeof b&&b%1!=0:"number"==a?"number"==typeof b:"boolean"==a?"boolean"==typeof b:"undefined"==a?"undefined"==typeof b:"null"==a?null===b:"array"==a?b instanceof Array:"date"==a?b instanceof Date:"function"==a?"function"==typeof b:"object"==a?!("object"!=typeof b||null===b||b instanceof Array||b instanceof Date||b instanceof RegExp):!1}if("object"==typeof a&&a.length){for(var d=a,e=0;e<d.length;e++)if(c(d[e],b))return!0;return!1}return c(a,b)},typeCheckObj:function(a,b){if("object"==typeof a){var c=this;for(var d in a){var e=a[d];"function"==typeof e&&!function(d,e){a[d]=function(){for(var a=arguments,f=b[d],g=0;g<a.length;g++)if(!c.typeCheck(f[g],a[g]))throw new Error("JUI_CRITICAL_ERR: the "+g+"th parameter is not a "+f[g]+" ("+name+")");return e.apply(this,a)}}(d,e)}}},dataToCsv:function(a,b,c){for(var d="",e=c?c:b.length,f=-1;e>f;f++){for(var g=[],h=0;h<a.length;h++)if(a[h])if(-1==f)g.push('"'+a[h]+'"');else{var i=b[f][a[h]];g.push(isNaN(i)?'"'+i+'"':i)}d+=g.join(",")+"\n"}return d},dataToCsv2:function(b){for(var c="",d=a.extend({fields:null,rows:null,names:null,count:this.typeCheck("integer",b.count)?b.count:b.rows.length},b),e=-1;e<d.count;e++){for(var f=[],g=0;g<d.fields.length;g++)if(d.fields[g])if(-1==e)f.push(d.names&&d.names[g]?'"'+d.names[g]+'"':'"'+d.fields[g]+'"');else{var h=d.rows[e][d.fields[g]];f.push(isNaN(h)?'"'+h+'"':h)}c+=f.join(",")+"\n"}return c},fileToCsv:function(a,b){var c=new FileReader;c.onload=function(a){"function"==typeof b&&b(a.target.result)},c.readAsText(a)},csvToBase64:function(a){return"data:application/octet-stream;base64,"+k.encode(a)},csvToData:function(b,c,d){for(var e=[],f=c.split("\n"),g=1;g<f.length;g++)if(""!=f[g]){for(var h=f[g].split(","),i={},j=0;j<b.length;j++)i[b[j]]=h[j],this.startsWith(h[j],'"')&&this.endsWith(h[j],'"')?i[b[j]]=h[j].split('"').join(""):i[b[j]]=h[j],-1!=a.inArray(b[j],d)&&(i[b[j]]=parseFloat(h[j]));e.push(i)}return e},getCsvFields:function(a,b){for(var c=this.typeCheck("array",b)?b:a,d=0;d<c.length;d++)isNaN(c[d])||(c[d]=a[c[d]]);return c},svgToBase64:function(a){return"data:image/svg+xml;base64,"+k.encode(a)},dateFormat:function(a,b,c){function d(a,b){var c=a+"";for(b=b||2;c.length<b;)c="0"+c;return c}var e=["\x00","January","February","March","April","May","June","July","August","September","October","November","December"],f=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=c?a.getUTCFullYear():a.getFullYear();b=b.replace(/(^|[^\\])yyyy+/g,"$1"+i),b=b.replace(/(^|[^\\])yy/g,"$1"+i.toString().substr(2,2)),b=b.replace(/(^|[^\\])y/g,"$1"+i);var j=(c?a.getUTCMonth():a.getMonth())+1;b=b.replace(/(^|[^\\])MMMM+/g,"$1"+e[0]),b=b.replace(/(^|[^\\])MMM/g,"$1"+f[0]),b=b.replace(/(^|[^\\])MM/g,"$1"+d(j)),b=b.replace(/(^|[^\\])M/g,"$1"+j);var k=c?a.getUTCDate():a.getDate();b=b.replace(/(^|[^\\])dddd+/g,"$1"+g[0]),b=b.replace(/(^|[^\\])ddd/g,"$1"+h[0]),b=b.replace(/(^|[^\\])dd/g,"$1"+d(k)),b=b.replace(/(^|[^\\])d/g,"$1"+k);var l=c?a.getUTCHours():a.getHours();b=b.replace(/(^|[^\\])HH+/g,"$1"+d(l)),b=b.replace(/(^|[^\\])H/g,"$1"+l);var m=l>12?l-12:0==l?12:l;b=b.replace(/(^|[^\\])hh+/g,"$1"+d(m)),b=b.replace(/(^|[^\\])h/g,"$1"+m);var n=c?a.getUTCMinutes():a.getMinutes();b=b.replace(/(^|[^\\])mm+/g,"$1"+d(n)),b=b.replace(/(^|[^\\])m/g,"$1"+n);var o=c?a.getUTCSeconds():a.getSeconds();b=b.replace(/(^|[^\\])ss+/g,"$1"+d(o)),b=b.replace(/(^|[^\\])s/g,"$1"+o);var p=c?a.getUTCMilliseconds():a.getMilliseconds();b=b.replace(/(^|[^\\])fff+/g,"$1"+d(p,3)),p=Math.round(p/10),b=b.replace(/(^|[^\\])ff/g,"$1"+d(p)),p=Math.round(p/10),b=b.replace(/(^|[^\\])f/g,"$1"+p);var q=12>l?"AM":"PM";b=b.replace(/(^|[^\\])TT+/g,"$1"+q),b=b.replace(/(^|[^\\])T/g,"$1"+q.charAt(0));var r=q.toLowerCase();b=b.replace(/(^|[^\\])tt+/g,"$1"+r),b=b.replace(/(^|[^\\])t/g,"$1"+r.charAt(0));var s=-a.getTimezoneOffset(),t=c||!s?"Z":s>0?"+":"-";if(!c){s=Math.abs(s);var u=Math.floor(s/60),v=s%60;t+=d(u)+":"+d(v)}b=b.replace(/(^|[^\\])K/g,"$1"+t);var w=(c?a.getUTCDay():a.getDay())+1;return b=b.replace(new RegExp(g[0],"g"),g[w]),b=b.replace(new RegExp(h[0],"g"),h[w]),b=b.replace(new RegExp(e[0],"g"),e[j]),b=b.replace(new RegExp(f[0],"g"),f[j]),b=b.replace(/\\(.)/g,"$1")},createId:function(a){return[a||"id",+new Date,Math.round(100*Math.random())%100].join("-")},btoa:k.encode,atob:k.decode,timeLoop:function(a,b){return function(c,d){function e(a){1>a||(1==a?(c.call(b,a),d.call(b)):setTimeout(function(){a>-1&&c.call(b,a--),a>-1&&e(a)},1))}e(a)}},loop:function(a,b){var c=0,d=a,e=Math.ceil(a/5);return function(a){for(var f=c,g=1*e,h=2*e,i=3*e,j=4*e,k=g,l=h,m=i,n=j,o=d;k>f&&d>f;)a.call(b,f,1),f++,l>g&&d>g&&(a.call(b,g,2),g++),m>h&&d>h&&(a.call(b,h,3),h++),n>i&&d>i&&(a.call(b,i,4),i++),o>j&&d>j&&(a.call(b,j,5),j++)}},loopArray:function(a,b){var c=a.length,d=0,e=c,f=Math.ceil(c/5);return function(c){for(var g=d,h=1*f,i=2*f,j=3*f,k=4*f,l=h,m=i,n=j,o=k,p=e;l>g&&e>g;)c.call(b,a[g],g,1),g++,m>h&&e>h&&(c.call(b,a[h],h,2),h++),n>i&&e>i&&(c.call(b,a[i],i,3),i++),o>j&&e>j&&(c.call(b,a[j],j,4),j++),p>k&&e>k&&(c.call(b,a[k],k,5),k++)}},makeIndex:function(a,b){var c={},d=this.loopArray(a);return d(function(a,d){var e=a[b];"undefined"==typeof c[e]&&(c[e]=[]),c[e].push(d)}),c},startsWith:function(a,b,c){return c=c||0,a.lastIndexOf(b,c)===c},endsWith:function(a,b,c){var d=a;(void 0===c||c>d.length)&&(c=d.length),c-=b.length;var e=d.indexOf(b,c);return-1!==e&&e===c}},n=function(a){for(var b=[],c=0;c<a.length;c++){var e=d[a[c]];if(m.typeCheck(["function","object"],e))b.push(e);else{var f=o(a[c]);if(null==f)throw new Error("JUI_CRITICAL_ERR: '"+a[c]+"' is not loaded");b.push(f)}}return b},o=function(a){var b=null,a=a+".";for(var c in d)if(-1!=c.indexOf(a)&&m.typeCheck(["function","object"],d[c])){var e=c.split(a).join("");-1==e.indexOf(".")&&(null==b&&(b={}),b[e]=d[c])}return b};b.jui=c.jui={ready:function(){var b=[],c=2==arguments.length?arguments[1]:arguments[0],d=2==arguments.length?arguments[0]:null;if(!m.typeCheck(["array","null"],d)||!m.typeCheck("function",c))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");a(function(){b=d?n(d):[o("ui"),o("uix"),m],c.apply(null,b)})},defineUI:function(a,b,c,g){if(!(m.typeCheck("string",a)&&m.typeCheck("array",b)&&m.typeCheck("function",c)&&m.typeCheck(["string","undefined"],g)))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");if(m.typeCheck("function",f[a]))throw new Error("JUI_CRITICAL_ERR: '"+a+"' is already exist");if(m.typeCheck("undefined",g)&&(g="core"),!m.typeCheck("function",f[g]))throw new Error("JUI_CRITICAL_ERR: Parents are the only function");if(e[g]!==!0)throw new Error("JUI_CRITICAL_ERR: UI function can not be inherited");var h=n(b),i=c.apply(null,h);m.inherit(i,f[g]),d[a]=f.core.init({type:a,"class":i}),f[a]=i,e[a]=!0,"function"==typeof define&&define.amd&&define(a,function(){return d[a]})},define:function(a,b,c,g){if(!(m.typeCheck("string",a)&&m.typeCheck("array",b)&&m.typeCheck("function",c)&&m.typeCheck(["string","undefined"],g)))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");if(m.typeCheck("function",f[a]))throw new Error("JUI_CRITICAL_ERR: '"+a+"' is already exist");var h=n(b),i=c.apply(null,h);if(m.typeCheck("function",f[g])){if(e[g]!==!0)throw new Error("JUI_CRITICAL_ERR: UI function can not be inherited");m.inherit(i,f[g])}d[a]=i,f[a]=i,e[a]=!0,"function"==typeof define&&define.amd&&define(a,function(){return d[a]})},defineOptions:function(b,c,d){function e(a,b){if(m.typeCheck("function",a)){if(m.typeCheck("function",a.setup)){var c=a.setup();for(var d in c)m.typeCheck("undefined",b[d])&&(b[d]=c[d])}e(a.parent,b)}return b}for(var f=e(b,{}),g=Object.keys(f),h=Object.keys(c),i=0;i<h.length;i++){var j=h[i];if(-1==a.inArray(j,g)&&-1==a.inArray(j,d))throw new Error("JUI_CRITICAL_ERR: '"+j+"' is not an option")}return m.extend(c,f,!0),c},include:function(a){if(!m.typeCheck("string",a))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");var b=d[a];if(m.typeCheck(["function","object"],b))return b;var c=o(a);if(null==c)throw new Error("JUI_CRITICAL_ERR: '"+a+"' is not loaded");return c},includeAll:function(){var a=[];for(var b in d)a.push(d[b]);return a},log:function(a){var c=b.open(a||h.logUrl,"JUIM","width=1024, height=768, toolbar=no, menubar=no, resizable=yes");return jui.debugAll(function(a,b){c.log(a,b)}),c},setup:function(a){return m.typeCheck("object",a)&&(h=m.extend(h,a)),h}}}(jQuery||$,window,"undefined"!=typeof global?global:window),jui.define("core",["jquery","util.base"],function(a,b){var c=new function(){var d=[],e=[];this.add=function(a){d.push(a)},this.emit=function(a,b,c){for(var e=[],f=0;f<d.length;f++){var g=d[f];(a==g.selector||a==g.type)&&e.push(g)}for(var f=0;f<e.length;f++)for(var g=e[f],h=0;h<g.length;h++)g[h].emit(b,c)},this.get=function(a){if(b.typeCheck("integer",a))return d[a];if(b.typeCheck("string",a)){for(var c=0;c<d.length;c++){var e=d[c];if(a==e.selector)return 1==e.length?e[0]:e}for(var f=[],c=0;c<d.length;c++){var e=d[c];a==e.type&&f.push(e)}return f}},this.getAll=function(){return d},this.remove=function(a){return b.typeCheck("integer",a)?d.splice(a,1)[0]:void 0},this.shift=function(){return d.shift()},this.pop=function(){return d.pop()},this.size=function(){return d.length},this.debug=function(b,c,d,e){if(b.__proto__){var f=["emit","on","addEvent","addValid","callBefore","callAfter","callDelay","setTpl","setVo","setOption"];for(var g in b){var h=b[g];"function"==typeof h&&-1==a.inArray(g,f)&&!function(a,d,f,g){b.__proto__[a]=function(){var b=Date.now(),h=d.apply(this,arguments),i=Date.now();return"function"==typeof e?e({type:jui.get(c).type,name:a,c_index:f,u_index:g,time:i-b},arguments):(console.log(isNaN(f)||isNaN(g)?"NAME("+a+"), TIME("+(i-b)+"ms), ARGUMENTS...":"TYPE("+jui.get(c).type+"), NAME("+a+"), INDEX("+f+":"+g+"), TIME("+(i-b)+"ms), ARGUMENTS..."),console.log(arguments),console.log("")),h}}(g,h,c,d)}}},this.debugAll=function(a){for(var b=0;b<d.length;b++)for(var c=d[b],e=0;e<c.length;e++)this.debug(c[e],b,e,a)},this.addClass=function(a){e.push(a)},this.getClass=function(a){if(b.typeCheck("integer",a))return e[a];if(b.typeCheck("string",a))for(var c=0;c<e.length;c++)if(a==e[c].type)return e[c];return null},this.getClassAll=function(){return e},this.create=function(a,d,e){var f=c.getClass(a);if(b.typeCheck("null",f))throw new Error("JUI_CRITICAL_ERR: '"+a+"' does not exist");return f["class"](d,e)}},d=function(){function c(b){for(var c=["webkit","moz","MS","o",""],d=0;d<c.length;d++){var e=b.type;c[d]||(e=e.toLowerCase()),a(b.target).on(c[d]+e,b.callback)}g.push(b)}function d(b){b.callback&&!b.children?a(b.target).on(b.type,b.callback):a(b.target).on(b.type,b.children,b.callback),g.push(b)}function e(b){b.callback&&!b.children?a(b.target).on(f(b.type),b.callback):a(b.target).on(f(b.type),b.children,b.callback),g.push(b)}function f(a){return{click:"touchstart",dblclick:"touchend",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}[a]}var g=[];this.add=function(f){var g={target:f[0],type:f[1]};b.typeCheck("function",f[2])?g=a.extend(g,{callback:f[2]}):b.typeCheck("string",f[2])&&(g=a.extend(g,{children:f[2],callback:f[3]}));for(var h=b.typeCheck("array",g.type)?g.type:[g.type],i=0;i<h.length;i++)g.type=h[i],-1!=g.type.toLowerCase().indexOf("animation")?c(g):("body"!=g.target&&g.target!=window&&g.target!=document&&a(g.target).off(g.type),b.isTouch?e(g):d(g))},this.trigger=function(c,d){a(c).trigger(b.isTouch?f(d):d)},this.get=function(a){return g[a]},this.getAll=function(){return g},this.size=function(){return g.length}},e=function(a,b,c,d){this.type=a,this.selector=b,this.options=c,this.destroy=function(){for(var a=0;a<d.length;a++)d[a].destroy()};for(var e=0;e<d.length;e++)this.push(d[e])};e.prototype=Object.create(Array.prototype);var f=function(){var c=null;this.find=function(b){return a(this.root).find(b)},this.emit=function(a,b){if("string"==typeof a){for(var c,d=0;d<this.event.length;d++){var e=this.event[d];if(e.type==a.toLowerCase()){var f="object"==typeof b&&b.length?b:[b];c=e.callback.apply(this,f)}}return c}},this.on=function(a,b){"string"==typeof a&&"function"==typeof b&&this.event.push({type:a.toLowerCase(),callback:b,unique:!1})},this.off=function(a){for(var b=[],c=0;c<this.event.length;c++){var d=this.event[c];("function"==typeof a&&d.callback!=a||"string"==typeof a&&d.type!=a.toLowerCase())&&b.push(d)}this.event=b},this.addEvent=function(){this.listen.add(arguments)},this.addTrigger=function(a,b){this.listen.trigger(a,b)},this.addValid=function(a,c){if(this.__proto__){var d=this.__proto__[a];this.__proto__[a]=function(){for(var e=arguments,f=0;f<e.length;f++)if(!b.typeCheck(c[f],e[f]))throw new Error("JUI_CRITICAL_ERR: the "+f+"th parameter is not a "+c[f]+" ("+a+")");return d.apply(this,e)}}},this.callBefore=function(a,b){if(this.__proto__){var c=this.__proto__[a];this.__proto__[a]=function(){var a=arguments;return"function"!=typeof b?c.apply(this,a):b.apply(this,a)!==!1?c.apply(this,a):void 0}}},this.callAfter=function(a,b){if(this.__proto__){var c=this.__proto__[a];this.__proto__[a]=function(){var a=arguments,d=c.apply(this,a);return"function"==typeof b&&d!==!1&&b.apply(this,a),d}}},this.callDelay=function(a,b){function c(a,c){var e=d.apply(a,c);"function"==typeof b.after&&e!==!1&&b.after.apply(a,c)}if(this.__proto__){var d=this.__proto__[a],e=isNaN(b.delay)?0:b.delay;this.__proto__[a]=function(){var a=this,d=arguments;"function"==typeof b.before&&b.before.apply(a,d),e>0?setTimeout(function(){c(a,d)},e):c(a,d)}}},this.setTpl=function(a,c){this.tpl[a]=b.template(c)},this.setVo=function(){this.options.vo&&(null!=c&&c.reload(),c=a(this.selector).jbinder(),this.bind=c)},this.setOption=function(a,b){if("object"==typeof a)for(var c in a)this.options[c]=a[c];else this.options[a]=b},this.destroy=function(){if(this.__proto__){for(var b=0;b<this.listen.size();b++){var c=this.listen.get(b);a(c.target).off(c.type)}for(var d in this.__proto__)delete this.__proto__[d]}}};return f.build=function(f){return function(g,h){var i=a(g||"<div />"),j=[];return i.each(function(c){var e=new f["class"],k=jui.defineOptions(f["class"],h||{});e.init.prototype=e,e.init.prototype.selector=i.selector,e.init.prototype.root=this,e.init.prototype.options=k,e.init.prototype.tpl={},e.init.prototype.event=new Array,e.init.prototype.listen=new d,e.init.prototype.timestamp=(new Date).getTime(),e.init.prototype.index=c,e.init.prototype.module=f,a("script").each(function(b){if(g==a(this).data("jui")||g==a(this).data("vo")||g instanceof HTMLElement){var c=a(this).data("tpl");if(""==c)throw new Error("JUI_CRITICAL_ERR: 'data-tpl' property is required");k.tpl[c]=a(this).html()}});for(var l in k.tpl){var m=k.tpl[l];b.typeCheck("string",m)&&""!=m&&(e.init.prototype.tpl[l]=b.template(m))}var n=new e.init;for(var o in k.event)n.on(o,k.event[o]);j[c]=n,this.jui=n}),c.add(new e(f.type,g,h,j)),0==j.length?null:1==j.length?j[0]:j}},f.init=function(a){var b=null;return"object"==typeof a&&(b=f.build(a),c.addClass({type:a.type,"class":b})),b},f.setup=function(){return{tpl:{},event:{},vo:null}},window.jui="object"==typeof jui?a.extend(jui,c):c,f}),jui.define("util.math",["util.base"],function(a){function b(a,b){for(var c=[],d=0,e=a.length;e>d;d++){for(var f=0,g=0,h=a[d].length;h>g;g++)f+=a[d][g]*b[g];c.push(f)}return c}function c(a,c){for(var d=[],e=[],f=0,g=c.length;g>f;f++)d[f]=[],e[f]=[];for(var f=0,g=c.length;g>f;f++)for(var h=0,i=c[f].length;i>h;h++)d[h].push(c[f][h]);for(var f=0,g=d.length;g>f;f++)for(var j=b(a,d[f]),h=0,i=j.length;i>h;h++)e[h].push(j[h]);return e}function d(a,b){var c=new Float32Array(4);return c[0]=a[0][0]*b[0]+a[0][1]*b[1]+a[0][2]*b[2]+a[0][3]*b[3],c[1]=a[1][0]*b[0]+a[1][1]*b[1]+a[1][2]*b[2]+a[1][3]*b[3],c[2]=a[2][0]*b[0]+a[2][1]*b[1]+a[2][2]*b[2]+a[2][3]*b[3],c[3]=a[3][0]*b[0]+a[3][1]*b[1]+a[3][2]*b[2]+a[3][3]*b[3],c}function e(a,b){var c=[new Float32Array(4),new Float32Array(4),new Float32Array(4),new Float32Array(4)],d=[new Float32Array([b[0][0],b[1][0],b[2][0],b[3][0]]),new Float32Array([b[0][1],b[1][1],b[2][1],b[3][1]]),new Float32Array([b[0][2],b[1][2],b[2][2],b[3][2]]),new Float32Array([b[0][3],b[1][3],b[2][3],b[3][3]])];return c[0][0]=a[0][0]*d[0][0]+a[0][1]*d[0][1]+a[0][2]*d[0][2]+a[0][3]*d[0][3],c[1][0]=a[1][0]*d[0][0]+a[1][1]*d[0][1]+a[1][2]*d[0][2]+a[1][3]*d[0][3],c[2][0]=a[2][0]*d[0][0]+a[2][1]*d[0][1]+a[2][2]*d[0][2]+a[2][3]*d[0][3],c[3][0]=a[3][0]*d[0][0]+a[3][1]*d[0][1]+a[3][2]*d[0][2]+a[3][3]*d[0][3],c[0][1]=a[0][0]*d[1][0]+a[0][1]*d[1][1]+a[0][2]*d[1][2]+a[0][3]*d[1][3],c[1][1]=a[1][0]*d[1][0]+a[1][1]*d[1][1]+a[1][2]*d[1][2]+a[1][3]*d[1][3],c[2][1]=a[2][0]*d[1][0]+a[2][1]*d[1][1]+a[2][2]*d[1][2]+a[2][3]*d[1][3],c[3][1]=a[3][0]*d[1][0]+a[3][1]*d[1][1]+a[3][2]*d[1][2]+a[3][3]*d[1][3],c[0][2]=a[0][0]*d[2][0]+a[0][1]*d[2][1]+a[0][2]*d[2][2]+a[0][3]*d[2][3],c[1][2]=a[1][0]*d[2][0]+a[1][1]*d[2][1]+a[1][2]*d[2][2]+a[1][3]*d[2][3],c[2][2]=a[2][0]*d[2][0]+a[2][1]*d[2][1]+a[2][2]*d[2][2]+a[2][3]*d[2][3],c[3][2]=a[3][0]*d[2][0]+a[3][1]*d[2][1]+a[3][2]*d[2][2]+a[3][3]*d[2][3],c[0][3]=a[0][0]*d[3][0]+a[0][1]*d[3][1]+a[0][2]*d[3][2]+a[0][3]*d[3][3],c[1][3]=a[1][0]*d[3][0]+a[1][1]*d[3][1]+a[1][2]*d[3][2]+a[1][3]*d[3][3],c[2][3]=a[2][0]*d[3][0]+a[2][1]*d[3][1]+a[2][2]*d[3][2]+a[2][3]*d[3][3],c[3][3]=a[3][0]*d[3][0]+a[3][1]*d[3][1]+a[3][2]*d[3][2]+a[3][3]*d[3][3],c}var f={rotate:function(a,b,c){return{x:a*Math.cos(c)-b*Math.sin(c),y:a*Math.sin(c)+b*Math.cos(c)}},resize:function(a,b,c,d){var e=d/c;return c>=a&&1>=e?(c=a,d=b*e):d>=b&&(d=b,c=a/e),{width:c,height:d}},radian:function(a){return a*Math.PI/180},degree:function(a){return 180*a/Math.PI},angle:function(a,b,c,d){var e=c-a,f=d-b;return Math.atan2(f,e)},interpolateNumber:function(a,b){var c=b-a;return function(b){return a+c*b}},interpolateRound:function(a,b){var c=b-a;return function(b){return Math.round(a+c*b)}},getFixed:function(a,b){var c=(a+"").split("."),d=c.length<2?0:c[1].length,e=(b+"").split("."),f=e.length<2?0:e[1].length;return d>f?d:f},fixed:function(a){var b=this.getFixed(a,0),c=Math.pow(10,b),d=function(a){return Math.round(a*c)/c};return d.plus=function(a,b){return Math.round(a*c+b*c)/c},d.minus=function(a,b){return Math.round(a*c-b*c)/c},d.multi=function(a,b){return Math.round(a*c*b*c)/(c*c)},d.div=function(a,b){var d=a*c/(b*c),e=Math.pow(10,this.getFixed(d,0));return Math.round(d*e)/e},d.remain=function(a,b){return Math.round(a*c%(b*c))/c},d},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},plus:function(a,b){var c=Math.pow(10,this.getFixed(a,b));return Math.round(a*c+b*c)/c},minus:function(a,b){var c=Math.pow(10,this.getFixed(a,b));return Math.round(a*c-b*c)/c},multi:function(a,b){var c=Math.pow(10,this.getFixed(a,b));return Math.round(a*c*b*c)/(c*c)},div:function(a,b){var c=Math.pow(10,this.getFixed(a,b)),d=a*c/(b*c),e=Math.pow(10,this.getFixed(d,0));return Math.round(d*e)/e},remain:function(a,b){var c=Math.pow(10,this.getFixed(a,b));return Math.round(a*c%(b*c))/c},nice:function(a,b,c,d){function e(a,b){var c=Math.floor(Math.log(a)/Math.LN10),d=a/Math.pow(10,c);return b?1.5>d?niceFraction=1:3>d?niceFraction=2:7>d?niceFraction=5:niceFraction=10:1>=d?niceFraction=1:2>=d?niceFraction=2:5>=d?niceFraction=5:niceFraction=10,niceFraction*Math.pow(10,c)}function f(){m=d?e(g-h,!1):g-h,l=d?e(m/k,!0):m/k,i=d?Math.floor(h/l)*l:h,j=d?Math.floor(g/l)*l:g}if(d=d||!1,a>b)var g=a,h=b;else var h=a,g=b;var i,j,k=c,l=0,m=[];return f(),{min:i,max:j,range:m,spacing:l}},matrix:function(d,e){return a.typeCheck("array",e[0])?c(d,e):b(d,e)},matrix3d:function(a,b){return b[0]instanceof Array||b[0]instanceof Float32Array?e(a,b):d(a,b)},scaleValue:function(a,b,c,d,e){function f(){var d=c-b,e=a-b,f=e/d;return f}b=b==c?0:b;var g=e-d,h=g*f();return h+d}};return f}),jui.define("util.transform",["util.math"],function(a){var b=function(b){function c(c){for(var d=0,e=b.length;e>d;d++)b[d]=a.matrix(c,b[d]);return b}this.matrix=function(){var b=arguments,c=b[0];return"move"==c?[new Float32Array([1,0,b[1]]),new Float32Array([0,1,b[2]]),new Float32Array([0,0,1])]:"scale"==c?[new Float32Array([b[1],0,0]),new Float32Array([0,b[2],0]),new Float32Array([0,0,1])]:"rotate"==c?[new Float32Array([Math.cos(a.radian(b[1])),-Math.sin(a.radian(b[1])),0]),new Float32Array([Math.sin(a.radian(b[1])),Math.cos(a.radian(b[1])),0]),new Float32Array([0,0,1])]:"move3d"==c?[new Float32Array([1,0,0,b[1]]),new Float32Array([0,1,0,b[2]]),new Float32Array([0,0,1,b[3]]),new Float32Array([0,0,0,1])]:"scale3d"==c?[new Float32Array([b[1],0,0,0]),new Float32Array([0,b[2],0,0]),new Float32Array([0,0,b[3],0]),new Float32Array([0,0,0,1])]:"rotate3dz"==c?[new Float32Array([Math.cos(a.radian(b[1])),-Math.sin(a.radian(b[1])),0,0]),new Float32Array([Math.sin(a.radian(b[1])),Math.cos(a.radian(b[1])),0,0]),new Float32Array([0,0,1,0]),new Float32Array([0,0,0,1])]:"rotate3dx"==c?[new Float32Array([1,0,0,0]),new Float32Array([0,Math.cos(a.radian(b[1])),-Math.sin(a.radian(b[1])),0]),new Float32Array([0,Math.sin(a.radian(b[1])),Math.cos(a.radian(b[1])),0]),new Float32Array([0,0,0,1])]:"rotate3dy"==c?[new Float32Array([Math.cos(a.radian(b[1])),0,Math.sin(a.radian(b[1])),0]),new Float32Array([0,1,0,0]),new Float32Array([-Math.sin(a.radian(b[1])),0,Math.cos(a.radian(b[1])),0]),new Float32Array([0,0,0,1])]:void 0},this.move=function(a,b){return c(this.matrix("move",a,b))},this.move3d=function(a,b,d){return c(this.matrix("move3d",a,b,d))},this.scale=function(a,b){return c(this.matrix("scale",a,b))},this.scale3d=function(a,b,d){return c(this.matrix("scale3d",a,b,d))},this.rotate=function(a){return c(this.matrix("rotate",a))},this.rotate3dz=function(a){return c(this.matrix("rotate3dz",a))},this.rotate3dx=function(a){return c(this.matrix("rotate3dx",a))},this.rotate3dy=function(a){return c(this.matrix("rotate3dy",a))},this.custom=function(a){return c(a)},this.merge=function(){for(var b=arguments,d=this.matrix.apply(this,b[0]),e=1;e<b.length;e++)d=a.matrix(d,this.matrix.apply(this,b[e]));return c(d)},this.merge2=function(c){for(var d=0,e=b.length;e>d;d++){for(var f=c.apply(null,b[d]),g=this.matrix.apply(this,f[0]),h=1;h<f.length;h++)g=a.matrix(g,this.matrix.apply(this,f[h]));b[d]=a.matrix(g,b[d])}}};return b}),jui.define("util.time",["util.base"],function(a){var b={MILLISECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:864e5,years:"years",months:"months",days:"days",hours:"hours",minutes:"minutes",seconds:"seconds",milliseconds:"milliseconds",weeks:"weeks",diff:function(a,c,d){var e=+c-+d;return"seconds"==a?Math.abs(Math.floor(e/b.MILLISECOND)):"minutes"==a?Math.abs(Math.floor(e/b.MINUTE)):"hours"==a?Math.abs(Math.floor(e/b.HOUR)):"days"==a?Math.abs(Math.floor(e/b.DAY)):e},add:function(a){if(arguments.length<=2)return a;if(arguments.length>2){for(var b=new Date(+a),c=1;c<arguments.length;c+=2){var d="string"==typeof arguments[c]?this[arguments[c]]:arguments[c],e=arguments[c+1];this.years==d?b.setFullYear(b.getFullYear()+e):this.months==d?b.setMonth(b.getMonth()+e):this.days==d?b.setDate(b.getDate()+e):this.hours==d?b.setHours(b.getHours()+e):this.minutes==d?b.setMinutes(b.getMinutes()+e):this.seconds==d?b.setSeconds(b.getSeconds()+e):this.milliseconds==d?b.setMilliseconds(b.getMilliseconds()+e):this.weeks==d&&b.setDate(b.getDate()+7*e)}return b}},format:function(b,c,d){return a.dateFormat(b,c,d)}};return b}),jui.define("util.scale",["util.math","util.time"],function(a,b){var c={circle:function(){function a(a){}var b=[],c=[],d=0;return a.domain=function(a){if("undefined"==typeof a)return b;for(var c=0;c<a.length;c++)b[c]=a[c];return this},a.range=function(a){if("undefined"==typeof a)return c;for(var b=0;b<a.length;b++)c[b]=a[b];return this},a.rangePoints=function(e,f){f=f||0;for(var g=b.length,h=(e[1]-e[0]-f)/g,i=[],j=0;j<b.length;j++)0==j?i[j]=e[0]+f/2+h/2:i[j]=i[j-1]+h;return c=i,d=h,a},a.rangeBands=function(e,f,g){f=f||0,g=g||0;for(var h=b.length,i=h-1,j=(e[1]-e[0])/i,k=[],l=0;l<b.length;l++)0==l?k[l]=e[0]:k[l]=j+k[l-1];return d=j,c=k,a},a.rangeBand=function(){return d},a},ordinal:function(){function a(a){var d=""+a;if("undefined"!=typeof e[d])return e[d];for(var f=-1,g=0;g<b.length;g++)if("string"==typeof a&&b[g]===a){f=g;break}return f>-1?(e[d]=c[f],c[f]):"undefined"!=typeof c[a]?(b[a]=a,e[d]=c[a],c[a]):null}var b=[],c=[],d=0,e={};return a.domain=function(a){if("undefined"==typeof a)return b;for(var c=0;c<a.length;c++)b[c]=a[c];return this},a.range=function(a){if("undefined"==typeof a)return c;for(var b=0;b<a.length;b++)c[b]=a[b];return this},a.rangePoints=function(e,f){f=f||0;for(var g=b.length,h=(e[1]-e[0]-f)/g,i=[],j=0;j<b.length;j++)0==j?i[j]=e[0]+f/2+h/2:i[j]=i[j-1]+h;return c=i,d=h,a},a.rangeBands=function(e,f,g){f=f||0,g=g||0;for(var h=b.length,i=h-1,j=(e[1]-e[0])/i,k=[],l=0;l<b.length;l++)0==l?k[l]=e[0]:k[l]=j+k[l-1];return d=j,c=k,a},a.rangeBand=function(){return d},a.invert=function(a){return Math.ceil(a/d)},a},time:function(){var a,d=[],e=c.linear(),f=e.domain;return e.domain=function(a){if(!arguments.length)return f.call(e);for(var b=0;b<a.length;b++)d[b]=+a[b];return f.call(e,d)},e.min=function(){return Math.min(d[0],d[d.length-1])},e.max=function(){return Math.max(d[0],d[d.length-1])},e.rate=function(a,b){return e(e.max()*(a/b))},e.ticks=function(c,f){for(var g=d[0],h=d[1],i=[];h>g;)i.push(new Date(+g)),g=b.add(g,c,f);i.push(new Date(+g));var j=e(i[1]),k=e(i[2]);return a=k-j,i},e.realTicks=function(c,f){
var g=d[0],h=d[1],i=[],j=new Date(+g),k=null;for(c==b.years?k=new Date(j.getFullYear(),0,1):c==b.months?k=new Date(j.getFullYear(),j.getMonth(),1):c==b.days||c==b.weeks?k=new Date(j.getFullYear(),j.getMonth(),j.getDate()):c==b.hours?k=new Date(j.getFullYear(),j.getMonth(),j.getDate(),j.getHours(),0,0,0):c==b.minutes?k=new Date(j.getFullYear(),j.getMonth(),j.getDate(),j.getHours(),j.getMinutes(),0,0):c==b.seconds?k=new Date(j.getFullYear(),j.getMonth(),j.getDate(),j.getHours(),j.getMinutes(),j.getSeconds(),0):c==b.milliseconds&&(k=new Date(j.getFullYear(),j.getMonth(),j.getDate(),j.getHours(),j.getMinutes(),j.getSeconds(),j.getMilliseconds())),k=b.add(k,c,f);+h>+k;)i.push(new Date(+k)),k=b.add(k,c,f);var l=e(i[1]),m=e(i[2]);return a=m-l,i},e.rangeBand=function(){return a},e.invert=function(a){var b=c.linear().domain(e.range()).range(e.domain());return new Date(b(a))},e},log:function(a){function b(a){return 0>a?-(Math.log(Math.abs(a))/Math.log(g)):a>0?Math.log(a)/Math.log(g):0}function d(a){return 0>a?-Math.pow(g,Math.abs(a)):a>0?Math.pow(g,a):0}function e(a){return Math.pow(g,(a+"").length-1)<a}function f(a){return Math.pow(g,(a+"").length)}var g=a||10,h=c.linear(),i=[],j=null,k=null,l=function(a){var c=a;return a>j?c=j:k>a&&(c=k),h(b(c))};return $.extend(l,h),l.log=function(){for(var a=[],c=0;c<i.length;c++)a[c]=b(i[c]);return a},l.domain=function(a){if(!arguments.length)return i;for(var b=0;b<a.length;b++)i[b]=a[b];if(j=Math.max.apply(Math,i),k=Math.min.apply(Math,i),e(j)&&(i[1]=j=f(j)),e(Math.abs(k))){var c=f(Math.abs(k));i[0]=k=0>k?-c:c}return h.domain(l.log()),l},l.base=function(a){return h.domain(l.log()),l},l.invert=function(a){return d(h.invert(a))},l.ticks=function(a,b,c){var e=h.ticks(a,b,c||1e20,!0);e[e.length-1]<h.max()&&e.push(h.max());for(var f=[],g=0,i=e.length;i>g;g++)f[g]=d(e[g]);return f},l},linear:function(){function b(a){if(a>l)return g?b(l):e[0]+Math.abs(a-d[1])*o/p;if(k>a)return g?b(k):e[0]-Math.abs(a-d[0])*o/p;var c=(a-d[0])/o;return q(c)}var d=[0,1],e=[0,1],f=!1,g=!1,h={},i=null,j=null,k=null,l=null,m=null,n=null,o=null,p=null,q=null,r=null;return b.cache=function(){return h},b.min=function(){return Math.min.apply(Math,d)},b.max=function(){return Math.max.apply(Math,d)},b.rangeMin=function(){return Math.min.apply(Math,e)},b.rangeMax=function(){return Math.max.apply(Math,e)},b.rate=function(a,c){return b(b.max()*(a/c))},b.clamp=function(a){g=a||!1},b.domain=function(a){if(!arguments.length)return d;for(var c=0;c<a.length;c++)d[c]=a[c];return k=b.min(),l=b.max(),o=d[1]-d[0],this},b.range=function(c){if(!arguments.length)return e;for(var d=0;d<c.length;d++)e[d]=c[d];return i=a.interpolateRound(e[0],e[1]),j=a.interpolateNumber(e[0],e[1]),m=b.rangeMin(),n=b.rangeMax(),p=Math.abs(n-m),q=f?i:j,this},b.rangeRound=function(a){return f=!0,b.range(a)},b.rangeBand=function(){return r},b.invert=function(a){var b=c.linear().domain(e).range(d);return b(a)},b.ticks=function(c,e,f,g){g=g||!1;var h=b.max();if(0==d[0]&&0==d[1])return[];for(var i=a.nice(d[0],d[1],c||10,e||!1),j=[],k=g?i.max:i.min,l=g?i.min:i.max,m=i.spacing,n=a.fixed(m);g?k>=l:l>=k;)j.push(k),k=g?n.minus(k,m):n.plus(k,m);if(g){j[0]!=h&&j.unshift(h);for(var o=0,p=j.length;p>o;o++)j[o]=Math.abs(j[o]-h)}else j[j.length-1]!=l&&k>l&&j.push(l),d[0]>d[1]&&j.reverse();var q=b(j[0]),s=b(j[1]);return r=Math.abs(s-q),j},b}};return c}),jui.define("util.color",["jquery","util.math"],function(a,b){var c={regex:/(linear|radial)\((.*)\)(.*)/i,format:function(a,b){if("hex"==b){var c=a.r.toString(16);a.r<16&&(c="0"+c);var d=a.g.toString(16);a.g<16&&(d="0"+d);var e=a.b.toString(16);return a.b<16&&(e="0"+e),"#"+[c,d,e].join("").toUpperCase()}return"rgb"==b?"undefined"==typeof a.a?"rgb("+[a.r,a.g,a.b].join(",")+")":"rgba("+[a.r,a.g,a.b,a.a].join(",")+")":a},scale:function(){function a(a,b){var f={r:parseInt(d.r+(e.r-d.r)*a,10),g:parseInt(d.g+(e.g-d.g)*a,10),b:parseInt(d.b+(e.b-d.b)*a,10)};return c.format(f,b)}var d,e;return a.domain=function(b,f){return d=c.rgb(b),e=c.rgb(f),a},a.ticks=function(c){for(var d=1/c,e=0,f=[];1>=e;){var g=a(e,"hex");f.push(g),e=b.plus(e,d)}return f},a},map:function(a,b){var d=[];b=b||5;for(var e=c.scale(),f=0,g=a.length-1;g>f;f++)if(0==f)d=e.domain(a[f],a[f+1]).ticks(b);else{var h=e.domain(a[f],a[f+1]).ticks(b);h.shift(),d=d.concat(h)}return d},rgb:function(b){if("string"==typeof b){if(b.indexOf("rgb(")>-1){for(var c=b.replace("rgb(","").replace(")","").split(","),d=0,e=c.length;e>d;d++)c[d]=parseInt(a.trim(c[d]),10);return{r:c[0],g:c[1],b:c[2],a:1}}if(b.indexOf("rgba(")>-1){for(var c=b.replace("rgba(","").replace(")","").split(","),d=0,e=c.length;e>d;d++)e-1==d?c[d]=parseFloat(a.trim(c[d])):c[d]=parseInt(a.trim(c[d]),10);return{r:c[0],g:c[1],b:c[2],a:c[3]}}if(0==b.indexOf("#")){b=b.replace("#","");var c=[];if(3==b.length)for(var d=0,e=b.length;e>d;d++){var f=b.substr(d,1);c.push(parseInt(f+f,16))}else for(var d=0,e=b.length;e>d;d+=2)c.push(parseInt(b.substr(d,2),16));return{r:c[0],g:c[1],b:c[2],a:1}}}return b},HSVtoRGB:function(a,b,c){360==a&&(a=0);var d=b*c,e=d*(1-Math.abs(a/60%2-1)),f=c-d,g=[];return a>=0&&60>a?g=[d,e,0]:a>=60&&120>a?g=[e,d,0]:a>=120&&180>a?g=[0,d,e]:a>=180&&240>a?g=[0,e,d]:a>=240&&300>a?g=[e,0,d]:a>=300&&360>a&&(g=[d,0,e]),{r:Math.ceil(255*(g[0]+f)),g:Math.ceil(255*(g[1]+f)),b:Math.ceil(255*(g[2]+f))}},RGBtoHSV:function(a,b,c){var d=a/255,e=b/255,f=c/255,g=Math.max(d,e,f),h=Math.min(d,e,f),i=g-h,j=0;0==i?j=0:g==d?j=60*((e-f)/i%6):g==e?j=60*((f-d)/i+2):g==f&&(j=60*((d-e)/i+4)),0>j&&(j=360+j);var k=0;k=0==g?0:i/g;var l=g;return{h:j,s:k,v:l}},trim:function(a){return(a||"").replace(/^\s+|\s+$/g,"")},lighten:function(a,b){a=a.replace(/[^0-9a-f]/gi,""),b=b||0;var c,d,e=[];for(d=0;6>d;d+=2)c=parseInt(a.substr(d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e.push(("00"+c).substr(c.length));return"#"+e.join("")},darken:function(a,b){return this.lighten(a,-b)},parse:function(a){return this.parseGradient(a)},parseGradient:function(a){var b=a.match(this.regex);if(!b)return a;var c=this.trim(b[1]),d=this.parseAttr(c,this.trim(b[2])),e=this.parseStop(this.trim(b[3])),f={type:c+"Gradient",attr:d,children:e};return f},parseStop:function(a){for(var b=a.split(","),c=[],d=0,e=b.length;e>d;d++){var a=b[d],f=a.split(" ");0!=f.length&&(1==f.length?c.push({type:"stop",attr:{"stop-color":f[0]}}):2==f.length?c.push({type:"stop",attr:{offset:f[0],"stop-color":f[1]}}):3==f.length&&c.push({type:"stop",attr:{offset:f[0],"stop-color":f[1],"stop-opacity":f[2]}}))}for(var g=-1,h=-1,d=0,e=c.length;e>d;d++){var a=c[d];if(0==d?a.offset||(a.offset=0):d==e-1&&(a.offset||(a.offset=1)),-1==g&&"undefined"==typeof a.offset)g=d;else if(-1==h&&"undefined"==typeof a.offset){h=d;for(var i=h-g,j=c[h].offset.indexOf("%")>-1?parseFloat(c[h].offset)/100:c[h].offset,k=c[g].offset.indexOf("%")>-1?parseFloat(c[g].offset)/100:c[g].offset,l=j-k,m=l/i,n=k+m,o=g+1;h>o;o++)c[o].offset=n,n+=m;g=h,h=-1}}return c},parseAttr:function(a,b){if("linear"!=a){for(var c=b.split(","),d=0,e=c.length;e>d;d++)-1==c[d].indexOf("%")&&(c[d]=parseFloat(c[d]));return{cx:c[0],cy:c[1],r:c[2],fx:c[3],fy:c[4]}}switch(b){case"":case"left":return{x1:0,y1:0,x2:1,y2:0,direction:b||"left"};case"right":return{x1:1,y1:0,x2:0,y2:0,direction:b};case"top":return{x1:0,y1:0,x2:0,y2:1,direction:b};case"bottom":return{x1:0,y1:1,x2:0,y2:0,direction:b};case"top left":return{x1:0,y1:0,x2:1,y2:1,direction:b};case"top right":return{x1:1,y1:0,x2:0,y2:1,direction:b};case"bottom left":return{x1:0,y1:1,x2:1,y2:0,direction:b};case"bottom right":return{x1:1,y1:1,x2:0,y2:0,direction:b};default:for(var c=b.split(","),d=0,e=c.length;e>d;d++)-1==c[d].indexOf("%")&&(c[d]=parseFloat(c[d]));return{x1:c[0],y1:c[1],x2:c[2],y2:c[3]}}}};return c.map.parula=function(a){return c.map(["#352a87","#0f5cdd","#00b5a6","#ffc337","#fdff00"],a)},c.map.jet=function(a){return c.map(["#00008f","#0020ff","#00ffff","#51ff77","#fdff00","#ff0000","#800000"],a)},c.map.hsv=function(a){return c.map(["#ff0000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff0000"],a)},c.map.hot=function(a){return c.map(["#0b0000","#ff0000","#ffff00","#ffffff"],a)},c.map.pink=function(a){return c.map(["#1e0000","#bd7b7b","#e7e5b2","#ffffff"],a)},c.map.bone=function(a){return c.map(["#000000","#4a4a68","#a6c6c6","#ffffff"],a)},c.map.copper=function(a){return c.map(["#000000","#3d2618","#9d623e","#ffa167","#ffc77f"],a)},c}),jui.define("util.svg.element",[],function(){var a=function(){var b=[];this.create=function(a,b){this.element=document.createElementNS("http://www.w3.org/2000/svg",a),this.children=[],this.parent=null,this.styles={},this.attributes={},this.order=0,this.attr(b)},this.each=function(a){if("function"==typeof a){for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];a.apply(d,[b,d])}return this.children}},this.get=function(a){return this.children[a]?this.children[a]:null},this.index=function(a){for(var b=0;b<this.children.length;b++)if(a==this.children[b])return b;return-1},this.append=function(b){return b instanceof a&&(b.parent&&b.remove(),this.children.push(b),b.parent=this),this},this.prepend=function(a){return this.insert(0,a)},this.insert=function(a,b){return b.parent&&b.remove(),this.children.splice(a,0,b),b.parent=this,this},this.remove=function(){for(var a=0,b=[],c=this.parent.children,d=0;d<c.length;d++){if(c[d]==this){a=d;break}b.push(c[d])}return this.parent.children=b,this},this.attr=function(a){if("undefined"!=typeof a&&a){if("string"==typeof a)return this.attributes[a]||this.element.getAttribute(a);for(var b in a)this.attributes[b]=a[b],-1!=b.indexOf("xlink:")?this.element.setAttributeNS("http://www.w3.org/1999/xlink",b,a[b]):this.element.setAttribute(b,a[b]);return this}},this.css=function(a){var b=[];for(var c in a)this.styles[c]=a[c];for(var c in a)b.push(c+":"+a[c]);return this.attr({style:b.join(";")}),this},this.html=function(a){return this.element.innerHTML=a,this},this.text=function(a){for(var b=this.element.childNodes,c=0;c<b.length;c++)this.element.removeChild(b[c]);return this.element.appendChild(document.createTextNode(a)),this},this.on=function(a,c){var d=function(a){"function"==typeof c&&c.call(this,a)};return this.element.addEventListener(a,d,!1),b.push({type:a,callback:d}),this},this.off=function(a){for(var c=[],d=0,e=b.length;e>d;d++){var f=b[d];f.type!=a?c.push(f):this.element.removeEventListener(a,f.callback,!1)}return b=c,this},this.hover=function(a,c){var d=function(b){"function"==typeof a&&a.call(this,b)},e=function(a){"function"==typeof c&&c.call(this,a)};return this.element.addEventListener("mouseover",d,!1),this.element.addEventListener("mouseout",e,!1),b.push({type:"mouseover",callback:d}),b.push({type:"mouseout",callback:e}),this},this.size=function(){var a={width:0,height:0},b=this.element.getBoundingClientRect();if(!b||0==b.width&&0==b.height){for(var c=["height","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth"],d=["width","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],e=window.getComputedStyle(this.element),f=0;f<c.length;f++)a.height+=parseFloat(e[c[f]]);for(var f=0;f<d.length;f++)a.width+=parseFloat(e[d[f]]);a.width=a.width||this.element.getAttribute("width"),a.height=a.height||this.element.getAttribute("height")}else a.width=b.width,a.height=b.height;return isNaN(a.width)&&(a.width=0),isNaN(a.height)&&(a.height=0),a},this.is=function(a){return this instanceof jui.include(a)}};return a}),jui.define("util.svg.element.transform",["util.base"],function(a){var b=function(){function b(a){var b=[];for(var c in d)d[c]&&b.push(d[c]);a.attr({transform:b.join(" ")})}function c(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b.join(",")}var d={translate:null,scale:null,rotate:null,skew:null,matrix:null};this.translate=function(){return d.translate="translate("+c(arguments)+")",b(this),this},this.rotate=function(a,c,e){if(1==arguments.length)var f=a;else if(3==arguments.length)var f=a+" "+c+","+e;return d.rotate="rotate("+f+")",b(this),this},this.scale=function(){return d.scale="scale("+c(arguments)+")",b(this),this},this.skew=function(){return d.skew="skew("+c(arguments)+")",b(this),this},this.matrix=function(){return d.matrix="matrix("+c(arguments)+")",b(this),this},this.data=function(b){var c=this.attr("transform"),d={translate:/[^translate()]+/g,rotate:/[^rotate()]+/g,scale:/[^scale()]+/g,skew:/[^skew()]+/g,matrix:/[^matrix()]+/g};return a.typeCheck("string",c)?c.match(d[b])[0]:null}};return b},"util.svg.element"),jui.define("util.svg.element.path",["util.base"],function(a){var b=function(){var b=[];this.moveTo=function(a,c,d){return b.push((d||"m")+a+","+c),this},this.MoveTo=function(a,b){return this.moveTo(a,b,"M")},this.lineTo=function(a,c,d){return b.push((d||"l")+a+","+c),this},this.LineTo=function(a,b){return this.lineTo(a,b,"L")},this.hLineTo=function(a,c){return b.push((c||"h")+a),this},this.HLineTo=function(a){return this.hLineTo(a,"H")},this.vLineTo=function(a,c){return b.push((c||"v")+a),this},this.VLineTo=function(a){return this.vLineTo(a,"V")},this.curveTo=function(a,c,d,e,f,g,h){return b.push((h||"c")+a+","+c+" "+d+","+e+" "+f+","+g),this},this.CurveTo=function(a,b,c,d,e,f){return this.curveTo(a,b,c,d,e,f,"C")},this.sCurveTo=function(a,c,d,e,f){return b.push((f||"s")+a+","+c+" "+d+","+e),this},this.SCurveTo=function(a,b,c,d){return this.sCurveTo(a,b,c,d,"S")},this.qCurveTo=function(a,c,d,e,f){return b.push((f||"q")+a+","+c+" "+d+","+e),this},this.QCurveTo=function(a,b,c,d){return this.qCurveTo(a,b,c,d,"Q")},this.tCurveTo=function(a,c,d,e,f){return b.push((f||"t")+a+","+c+" "+d+","+e),this},this.TCurveTo=function(a,b,c,d){return this.tCurveTo(a,b,c,d,"T")},this.arc=function(a,c,d,e,f,g,h,i){return e=e?1:0,f=f?1:0,b.push((i||"a")+a+","+c+" "+d+" "+e+","+f+" "+g+","+h),this},this.Arc=function(a,b,c,d,e,f,g){return this.arc(a,b,c,d,e,f,g,"A")},this.closePath=function(a){return b.push(a||"z"),this},this.ClosePath=function(){return this.closePath("Z")},this.join=function(){b.length>0&&(this.attr({d:b.join(" ")}),b=[])},this.length=function(){var c=a.createId(),d=b.join(" "),e=document.createElement("svg"),f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"id",c),f.setAttributeNS(null,"d",d),e.appendChild(f),document.body.appendChild(e);var g=document.getElementById(c).getTotalLength();return document.body.removeChild(e),g}};return b},"util.svg.element.transform"),jui.define("util.svg.element.path.symbol",["util.base"],function(a){var b=function(){var a="";this.template=function(a,b){var c=a,d=half_r=a/2,e=b/2,f="a"+half_r+","+half_r+" 0 1,1 "+c+",0",g="a"+half_r+","+half_r+" 0 1,1 "+-c+",0",h={triangle:["m0,"+-e,"l"+d+","+b,"l"+-a+",0","l"+d+","+-b].join(" "),rect:["m"+-d+","+-e,"l"+a+",0","l0,"+b,"l"+-a+",0","l0,"+-b].join(" "),cross:["m"+-d+","+-e,"l"+a+","+b,"m0,"+-b,"l"+-a+","+b].join(" "),circle:["m"+-c+",0",f,g].join(" ")};return h.rectangle=h.rect,h},this.join=function(){a.length>0&&(this.attr({d:a}),a="")},this.add=function(b,c,d){a+=" M"+b+","+c+d},this.triangle=function(a,b,c,d){return this.MoveTo(a,b).moveTo(0,-d/2).lineTo(c/2,d).lineTo(-c,0).lineTo(c/2,-d)},this.rect=this.rectangle=function(a,b,c,d){return this.MoveTo(a,b).moveTo(-c/2,-d/2).lineTo(c,0).lineTo(0,d).lineTo(-c,0).lineTo(0,-d)},this.cross=function(a,b,c,d){return this.MoveTo(a,b).moveTo(-c/2,-d/2).lineTo(c,d).moveTo(0,-d).lineTo(-c,d)},this.circle=function(a,b,c){return this.MoveTo(a,b).moveTo(-c,0).arc(c/2,c/2,0,1,1,c,0).arc(c/2,c/2,0,1,1,-c,0)}};return b},"util.svg.element.path"),jui.define("util.svg.element.path.rect",["util.math"],function(a){var b=function(){this.round=function(a,b,c,d,e,f){c=c?c:0,d=d?d:0,e=e?e:0,f=f?f:0,this.MoveTo(0,c).Arc(c,c,0,0,1,c,0).HLineTo(a-d).Arc(d,d,0,0,1,a,d).VLineTo(b-e).Arc(e,e,0,0,1,a-e,b).HLineTo(f).Arc(f,f,0,0,1,0,b-f).ClosePath().join()}};return b},"util.svg.element.path"),jui.define("util.svg.element.poly",[],function(){var a=function(){var a=[];this.point=function(b,c){return a.push(b+","+c),this},this.join=function(){if(a.length>0){var b=a[0];a.push(b),this.attr({points:a.join(" ")}),a=[]}}};return a},"util.svg.element.transform"),jui.define("util.svg.base",["util.base","util.math","util.color","util.svg.element","util.svg.element.transform","util.svg.element.path","util.svg.element.path.symbol","util.svg.element.path.rect","util.svg.element.poly"],function(a,b,c,d,e,f,g,h,i){var j=null,k=function(){this.create=function(a,b,c,d){return a.create(b,c),a},this.createChild=function(a,b,c,d){return this.create(a,b,c,d)},this.custom=function(a,b,c){return this.create(new d,a,b,c)},this.defs=function(a){return this.create(new d,"defs",null,a)},this.symbol=function(a,b){return this.create(new d,"symbol",a,b)},this.g=this.group=function(a,b){return this.create(new e,"g",a,b)},this.marker=function(a,b){return this.create(new d,"marker",a,b)},this.a=function(a,b){return this.create(new e,"a",a,b)},this["switch"]=function(a,b){return this.create(new d,"switch",a,b)},this.use=function(a){return this.create(new d,"use",a)},this.rect=function(a,b){return this.create(new e,"rect",a,b)},this.line=function(a,b){return this.create(new e,"line",a,b)},this.circle=function(a,b){return this.create(new e,"circle",a,b)},this.text=function(b,c){return 2==arguments.length?a.typeCheck("function",c)?this.create(new e,"text",b,c):this.create(new e,"text",b).text(c):this.create(new e,"text",b)},this.textPath=function(b,c){return a.typeCheck("string",c)?this.create(new d,"textPath",b).text(c):this.create(new d,"textPath",b)},this.tref=function(b,c){return a.typeCheck("string",c)?this.create(new d,"tref",b).text(c):this.create(new d,"tref",b)},this.tspan=function(b,c){return a.typeCheck("string",c)?this.create(new d,"tspan",b).text(c):this.create(new d,"tspan",b)},this.ellipse=function(a,b){return this.create(new e,"ellipse",a,b)},this.image=function(a,b){return this.create(new e,"image",a,b)},this.path=function(a,b){return this.create(new f,"path",a,b)},this.pathSymbol=function(a,b){return this.create(new g,"path",a,b)},this.pathRect=function(a,b){return this.create(new h,"path",a,b)},this.polyline=function(a,b){return this.create(new i,"polyline",a,b)},this.polygon=function(a,b){return this.create(new i,"polygon",a,b)},this.pattern=function(a,b){return this.create(new d,"pattern",a,b)},this.mask=function(a,b){return this.create(new d,"mask",a,b)},this.clipPath=function(a,b){return this.create(new d,"clipPath",a,b)},this.linearGradient=function(a,b){return this.create(new d,"linearGradient",a,b)},this.radialGradient=function(a,b){return this.create(new d,"radialGradient",a,b)},this.filter=function(a,b){return this.create(new d,"filter",a,b)},this.foreignObject=function(a,b){return this.create(new e,"foreignObject",a,b)},this.stop=function(a){return this.createChild(new d,"stop",a)},this.animate=function(a){return this.createChild(new d,"animate",a)},this.animateColor=function(a){return this.createChild(new d,"animateColor",a)},this.animateMotion=function(a){return this.createChild(new d,"animateMotion",a)},this.animateTransform=function(a){return this.createChild(new d,"animateTransform",a)},this.mpath=function(a){return this.createChild(new d,"mpath",a)},this.set=function(a){return this.createChild(new d,"set",a)},this.feBlend=function(a){return this.createChild(new d,"feBlend",a)},this.feColorMatrix=function(a){return this.createChild(new d,"feColorMatrix",a)},this.feComponentTransfer=function(a){return this.createChild(new d,"feComponentTransfer",a)},this.feComposite=function(a){return this.createChild(new d,"feComposite",a)},this.feConvolveMatrix=function(a){return this.createChild(new d,"feConvolveMatrix",a)},this.feDiffuseLighting=function(a){return this.createChild(new d,"feDiffuseLighting",a)},this.feDisplacementMap=function(a){return this.createChild(new d,"feDisplacementMap",a)},this.feFlood=function(a){return this.createChild(new d,"feFlood",a)},this.feGaussianBlur=function(a){return this.createChild(new d,"feGaussianBlur",a)},this.feImage=function(a){return this.createChild(new d,"feImage",a)},this.feMerge=function(a,b){return this.createChild(new d,"feMerge",a,b)},this.feMergeNode=function(a){return this.createChild(new d,"feMergeNode",a)},this.feMorphology=function(a){return this.createChild(new d,"feMorphology",a)},this.feOffset=function(a){return this.createChild(new d,"feOffset",a)},this.feSpecularLighting=function(a){return this.createChild(new d,"feSpecularLighting",a)},this.feTile=function(a){return this.createChild(new d,"feTile",a)},this.feTurbulence=function(a){return this.createChild(new d,"feTurbulence",a)}};return k.create=function(a,b,c){return null==j&&(j=new k),j.custom(a,b,c)},k}),jui.define("util.svg.3d",["util.base","util.math","util.color"],function(a,b,c){var d=function(){this.rect3d=function(a,d,e,f,g){var h=this,i=b.radian(f),j=0,k=0,l=d,m=e,n=Math.cos(i)*g,o=Math.sin(i)*g,p=d+n,q=e+o,r=h.group({},function(){h.path({fill:c.lighten(a,.15),stroke:c.lighten(a,.15)}).MoveTo(n,j).LineTo(p,k).LineTo(l,o).LineTo(j,o),h.path({fill:a,stroke:a}).MoveTo(j,o).LineTo(j,q).LineTo(l,q).LineTo(l,o),h.path({fill:c.darken(a,.2),stroke:c.darken(a,.2)}).MoveTo(l,q).LineTo(p,m).LineTo(p,k).LineTo(l,o)});return r},this.cylinder3d=function(d,e,f,g,h,i){var j=this,k=b.radian(g),i=void 0==i?1:0==i?.01:i,l=e/2,m=l*i,n=Math.cos(k)*h/2,o=Math.sin(k)*h/2,p=a.createId("cylinder3d"),q=j.group({},function(){j.ellipse({fill:c.darken(d,.05),"fill-opacity":.85,stroke:c.darken(d,.05),rx:l,ry:o,cx:l,cy:f}).translate(n,o),j.path({fill:"url(#"+p+")","fill-opacity":.85,stroke:d}).MoveTo(l-m,o).LineTo(0,f).Arc(l,o,0,0,0,e,f).LineTo(l+m,o).Arc(l+m,o,0,0,1,l-m,o).translate(n,o),j.ellipse({fill:c.lighten(d,.2),"fill-opacity":.95,stroke:c.lighten(d,.2),rx:l*i,ry:o*i,cx:l,cy:o}).translate(n,o),j.linearGradient({id:p,x1:"100%",x2:"0%",y1:"0%",y2:"0%"},function(){j.stop({offset:"0%","stop-color":c.lighten(d,.15)}),j.stop({offset:"33.333333333333336%","stop-color":c.darken(d,.2)}),j.stop({offset:"66.66666666666667%","stop-color":c.darken(d,.2)}),j.stop({offset:"100%","stop-color":c.lighten(d,.15)})})});return q}};return d},"util.svg.base"),jui.define("util.svg",["util.base","util.math","util.color","util.svg.element","util.svg.element.transform","util.svg.element.path","util.svg.element.path.symbol","util.svg.element.path.rect","util.svg.element.poly"],function(a,b,c,d,e,f,g,h,i){var j=function(b,c){function g(){k.root=l=new d,m=new e,n=new e,l.create("svg",c),m.create("g"),n.create("g"),m.translate(.5,.5),n.translate(.5,.5),b.appendChild(l.element),l.append(m),l.append(n)}function h(a){var b=a.children;j(b)&&b.sort(function(a,b){return a.order-b.order});for(var c=0,d=b.length;d>c;c++){var e=b[c];e&&(e.children.length>0&&h(e),(e instanceof f||e instanceof i)&&e.join(),e.parent==a&&a.element.appendChild(e.element))}}function j(a){for(var b=0,c=a.length;c>b;b++)if(a[b].order>0)return!0;return!1}var k=this,l=null,m=null,n=null,o={},p=0,q=!1;this.create=function(b,c,d,e){return b.create(c,d),0==p?m.append(b):o[p].append(b),a.typeCheck("function",e)&&(p++,o[p]=b,e.call(b),p--),b},this.createChild=function(a,b,c,d){if(a.parent==m)throw new Error("JUI_CRITICAL_ERR: Parents are required elements of the '"+b+"'");return this.create(a,b,c,d)},this.size=function(){if(2!=arguments.length)return l.size();var a=arguments[0],b=arguments[1];l.attr({width:a,height:b})},this.clear=function(a){m.each(function(){this.element.parentNode&&m.element.removeChild(this.element)}),a===!0&&n.each(function(){this.element.parentNode&&n.element.removeChild(this.element)})},this.reset=function(a){this.clear(a),m.children=[],a===!0&&(n.children=[])},this.render=function(a){this.clear(),h(q===!1||a===!0?l:m),q=!0},this.download=function(b){a.typeCheck("string",b)&&(b=b.split(".")[0]);var c=document.createElement("a");c.download=b?b+".svg":"svg.svg",c.href=this.toDataURI(),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c)},this.downloadImage=function(b,c){c=c||"image/png";var d=new Image,e=this.size(),f=this.toDataURI().replace('width="100%"','width="'+e.width+'"').replace('height="100%"','height="'+e.height+'"');d.onload=function(){var e=document.createElement("canvas");e.width=d.width,e.height=d.height;var f=e.getContext("2d");f.drawImage(d,0,0);var g=e.toDataURL(c);a.typeCheck("string",b)&&(b=b.split(".")[0]);var h=document.createElement("a");h.download=b?b+".png":"svg.png",h.href=g,document.body.appendChild(h),h.click(),h.parentNode.removeChild(h)},d.src=f},this.exportCanvas=function(a){var b=new Image,c=this.size(),d=this.toDataURI().replace('width="100%"','width="'+c.width+'"').replace('height="100%"','height="'+c.height+'"');b.onload=function(){a.width=b.width,a.height=b.height;var c=a.getContext("2d");c.drawImage(b,0,0)},b.src=d},this.toXML=function(){var a=b.innerHTML;return a=a.replace('xmlns="http://www.w3.org/2000/svg"',""),['<?xml version="1.0" encoding="utf-8"?>',a.replace("<svg ",'<svg xmlns="http://www.w3.org/2000/svg" ')].join("\n")},this.toDataURI=function(){var b=this.toXML();return(a.browser.mozilla||a.browser.msie)&&(b=encodeURIComponent(b)),a.browser.msie?"data:image/svg+xml,"+b:"data:image/svg+xml;utf8,"+b},this.autoRender=function(a,b){p>0||(b?m.append(a):n.append(a))},this.getTextSize=function(a){if(""==a)return{width:0,height:0};var b=document.createElementNS("http://www.w3.org/2000/svg","text");b.setAttributeNS(null,"x",-200),b.setAttributeNS(null,"y",-200),b.appendChild(document.createTextNode(a)),l.element.appendChild(b);var c=b.getBoundingClientRect();return l.element.removeChild(b),{width:c.width,height:c.height}},g()};return j.createObject=function(a){var b=new d;if(b.create(a.type,a.attr),a.children instanceof Array)for(var c=0,e=a.children.length;e>c;c++)b.append(j.createObject(a.children[c]));return b},j},"util.svg.3d"),jui.defineUI("ui.dropdown",["jquery"],function(a){var b=function(){var a=c();null!=a&&a.hide()},c=function(){for(var a=jui.get("ui.dropdown"),b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.length;d++)if("show"==c[d].type)return c[d];return null};a(function(){a("body").on("click",function(a){var c=a.target.tagName;"LI"!=c&&"INPUT"!=c&&"A"!=c&&"BUTTON"!=c&&"I"!=c&&b()}),a(window).on("keydown",function(a){var b=c();null!=b&&b.wheel(a.which,function(){a.preventDefault()})})});var d=function(){function c(c){function d(a){var b=0;return f.each(function(c){a==this&&(b=c)}),b}var f=a(e.menu).find("li");f.off("click").off("hover"),c.addEvent(f,"click",function(e){if(!a(this).hasClass("divider")&&!a(this).hasClass("title")){var f=d(this),g=a(this).text(),h=a(this).attr("value");c.emit("change",[{index:f,value:h,text:g},e]),c.options.close&&b(),"A"==e.target.tagName&&e.preventDefault()}}),c.addEvent(f,"hover",function(a){f.removeClass("active")})}function d(a,b){var c=e.menu.find("li"),d=c.eq(f);c.removeClass("active"),""!=d.val()||""!=d.html()?(d.addClass("active"),a.options.height>0&&e.menu.scrollTop(f*d.outerHeight())):"function"==typeof b&&b()}var e=null,f=-1;this.init=function(){var b=this.options,d=a(this.root),f=d.find("ul"),g=d.find(".anchor");f=0==f.size()?d:f,e={root:d,menu:f,anchor:g},e.root.outerWidth(e.menu.outerWidth()),b.width>0&&f.outerWidth(b.width),b.height>0&&f.css({maxHeight:b.height,overflow:"auto"}),b.left>0&&d.css("left",b.left),b.top>0&&d.css("top",b.top),f.css({display:"block"}),d.css({position:"absolute",display:"none"}),b.nodes.length>0?this.update(b.nodes):c(this),this.type="hide"},this.update=function(b){if(this.tpl.node){a(e.menu).empty();for(var d=0;d<b.length;d++)a(e.menu).append(this.tpl.node(b[d]));c(this)}},this.hide=function(){e.root.hide(),this.emit("hide"),this.type="hide"},this.show=function(a,c){b(),e.root.show(),e.anchor.size()>0&&e.root.css("margin-top","10px"),2==arguments.length&&this.move(a,c),this.emit("show"),this.type="show"},this.move=function(a,b){e.root.css("left",a),e.root.css("top",b)},this.wheel=function(a,b){if(this.options.keydown){var c=this,g=e.menu.find("li");(38==a||-1==a)&&(1>f?f=g.size()-1:f--,d(this,function(){f--,d(c)}),b&&b()),(40==a||1==a)&&(f<g.size()-1?f++:f=0,d(c,function(){f++,d(c)}),b&&b()),13!=a&&0!=a&&a||(c.addTrigger(g.eq(f),"click"),f=-1,b&&b())}},this.reload=function(){this.init(),this.emit("reload")}};return d.setup=function(){return{close:!0,keydown:!1,left:0,top:0,width:0,height:0,nodes:[]}},d}),jui.defineUI("ui.modal",["jquery","util.base"],function(a,b){var c=0;b.resize(function(){if(c!=a(window).width()){for(var b=jui.get("ui.modal"),d=0;d<b.length;d++)for(var e=b[d],f=0;f<e.length;f++)"show"==e[f].type&&e[f].resize();c=a(window).width()}},300);var d=function(){function b(b){h={position:a(b.root).css("position"),left:a(b.root).css("left"),top:a(b.root).css("top"),"z-index":a(b.root).css("z-index"),display:a(b.root).css("display")},i={position:a(b.options.target).css("position")}}function c(b){return"body"==b?null:a(b).hasClass("msgbox")||a(b).hasClass("window")?"absolute":"relative"}function d(b){var d=b.options.target,e="body"==d?window:d,f="body"==d?"fixed":"absolute",g=c(d),h=a(d).scrollLeft(),i=a(e).width()/2-a(b.root).width()/2+a(d).scrollLeft(),j=a(e).height()/2-a(b.root).height()/2,k=h>0?a(d).outerWidth()+h:"100%",l=a(d).outerHeight();if(null!=g){var m=a(e)[0].scrollHeight;l=m>l?m:l,j+=a(e).scrollTop()}else{var m=a(window).outerHeight();l=l>m?l:m}return{x:i,y:j,pos:f,tPos:g,w:k,h:l}}function e(b,c,d){var e=b.timestamp;null==f[e]&&(f[e]=a("<div id='MODAL_"+b.timestamp+"'></div>").css({position:"absolute",width:c,height:d,left:0,top:0,opacity:b.options.opacity,"background-color":b.options.color,"z-index":j+b.options.index-1}),a(b.options.target).append(f[e]),a(b.root).insertAfter(f[e]),b.addEvent(f[e],"click",function(a){return b.options.autoHide&&b.hide(),!1}))}var f={},g=null,h=null,i=null,j=5e3;this.init=function(){b(this),this.options.clone||a(this.root).hide(),this.type="hide"},this.hide=function(){var b=this.options,c=this.timestamp;b.clone&&(g.remove(),g=null),a(b.target).css("position",i.position),a(this.root).css(h),f[c]&&(f[c].remove(),delete f[c]),this.type="hide"},this.show=function(){var b=this.options,c=d(this);b.clone&&(g=a(this.root).clone(),g.insertAfter(a(this.root))),a(this.root).appendTo(b.target),this.resize(),a(b.target).css("position",c.tPos),a(this.root).show(),e(this,c.w,c.h),this.type="show"},this.resize=function(){var b=d(this),c=this.timestamp;a(this.root).css({position:b.pos,left:b.x,top:b.y,"z-index":j+this.options.index}),null!=f[c]&&f[c].height(b.h)}};return d.setup=function(){return{color:"black",opacity:.4,target:"body",index:0,clone:!1,autoHide:!0}},d}),jui.define("uix.table.column",["jquery"],function(a){var b=function(b){this.element=null,this.order="asc",this.name=null,this.data=[],this.list=[],this.index=b,this.type="show",this.width=null,this.hide=function(){this.type="hide",a(this.element).hide()},this.show=function(){this.type="show",a(this.element).show()}};return b}),jui.define("uix.table.row",["jquery"],function(a){var b=function(b,c,d){function e(a){k.rownum=isNaN(a)?k.rownum:a,k.parent?k.index=k.parent.index+"."+k.rownum:k.index=""+k.rownum,k.parent&&"string"==typeof k.index&&(k.depth=k.index.split(".").length-1),k.isLeaf()||f(k)}function f(a){for(var b=a.children,c=0;c<b.length;c++)b[c].reload(c),b[c].isLeaf()||f(b[c])}function g(){k.list=[],a(k.element).find("td").each(function(a){k.list[a]=this,l[a]&&(this.style.display="none")})}function h(){if(!c)return k.element;var b=a(c(a.extend({row:{index:k.index,data:k.data,depth:k.depth}},k.data))).get(0);return b}function i(b){a(b.element).remove();for(var c=0;c<b.children.length;c++){var d=b.children[c];d.isLeaf()?a(d.element).remove():i(d)}}function j(){for(var a=0;a<k.children.length;a++)k.children[a].reload(a)}var k=this,l={};this.data=b,this.rownum=null,this.index=null,this.element=null,this.list=[],this.parent=d?d:null,this.children=[],this.depth=0,this.type="fold",this.reload=function(b,c,d){if(c||e(b),null!=this.element){var f=h(),i=a(this.element).attr("class");a(f).addClass(i).insertAfter(this.element),a(this.element).remove(),this.element=f}else this.element=h();null!=d&&this.hideCells(d),
g()},this.destroy=function(){null!=this.parent?this.parent.removeChild(this.index):(i(this),a(this.element).remove())},this.isLeaf=function(){return 0==this.children.length?!0:!1},this.fold=function(){this.type="fold";for(var b=0;b<this.children.length;b++){var c=this.children[b];a(c.element).hide(),c.isLeaf()||c.fold()}},this.open=function(){this.type="open";for(var b=0;b<this.children.length;b++){var c=this.children[b];a(c.element).show(),c.isLeaf()||c.open()}},this.appendChild=function(b){var c=this.isLeaf()?this.element:this.lastChildLeaf().element;a(b.element).insertAfter(c),this.children.push(b)},this.insertChild=function(b,c,d){var e=this.element;if(b>0){var f=this.children[b-1];e=f.isLeaf()&&this.children.length!=b+1?f.element:f.lastChildLeaf().element}a(c.element).insertAfter(e);var g=this.children.splice(0,b);g.push(c),this.children=g.concat(this.children),j()},this.removeChild=function(a){for(var b=0;b<this.children.length;b++){var c=this.children[b];c.index==a&&(this.children.splice(b,1),i(c))}j()},this.lastChild=function(){return this.isLeaf()?null:this.children[this.children.length-1]},this.lastChildLeaf=function(a){var b=a?a:this.lastChild();return b.isLeaf()?b:this.lastChildLeaf(b.lastChild())},this.showCell=function(b){l[b]=!1,a(this.list[b]).show()},this.hideCell=function(b){l[b]=!0,a(this.list[b]).hide()},this.hideCells=function(a){for(var b=0;b<a.length;b++)"hide"==a[b].type&&this.hideCell(b)}};return b}),jui.define("uix.table.base",["jquery","util.base","uix.table.column","uix.table.row"],function(a,b,c,d){var e=function(e,f){function g(){r(),h()}function h(){var b=[];t.thead.find("tr:last > th").each(function(a){b.push(this)});for(var d=0;d<b.length;d++){var e=new c(d);v[d]?(e.element=v[d].element,e.order=v[d].order,e.name=v[d].name,e.data=v[d].data,e.list=v[d].list,e.type=v[d].type,e.width=v[d].width):(e.element=b[d],(a(e.element).attr("width")||a(e.element).attr("style")&&-1!=a(e.element).attr("style").indexOf("width"))&&(e.width=a(e.element).outerWidth()),f&&f[d]&&(e.name=f[d]));for(var g=0;g<w.length;g++)e.list.push(w[g].list[d]),e.data.push(w[g].data[e.name]);v[d]=e}}function i(a,b){if("reload"==a||"append"==a)for(var c=0;c<v.length;c++)v[c].list[b.index]=b.list[c],v[c].data[b.index]=b.data[v[c].name];else if("remove"==a)for(var c=0;c<v.length;c++)v[c].list.splice(b.index,1),v[c].data.splice(b.index,1);else h()}function j(a,b,c){var e=new d(a,u.row,c);return e.reload(b,!1,v),e}function k(a,b){var c=b.children;if(c.length>0)for(var d=0;d<c.length;d++)a.push(c[d]),c[d].children.length>0&&k(a,c[d])}function l(a,b){if(!b)return null;var c=a.shift();return void 0==c?b:l(a,b.children[c])}function m(){var a=arguments[0],b=arguments[1];"function"==typeof a?(b=a,a=0):a=isNaN(a)?0:a;for(var c=a;c<w.length;c++)w[c].reload(c),i("reload",w[c]),"function"==typeof b&&b(c)}function n(b,c){var d=j(c,b),e=d;if(w.length!=b||0==b&&1==w.length)a(d.element).insertBefore(w[b].element);else{var f=w[b-1];a(d.element).insertAfter(0==f.children.length?f.element:f.lastChildLeaf().element)}return e=w.splice(0,b),e.push(d),w=e.concat(w),m(b),d}function o(a,b){var c=z.getIndexList(a),d=s.getRowParent(a),e=c[c.length-1];return row=j(b,e,d),d.insertChild(e,row),row}function p(a){var b=j(a,w.length);return w.push(b),t.tbody.append(b.element),i("append",b),b}function q(a,b){var c=s.getRow(a),d=j(b,c.children.length,c);return c.appendChild(d),d}function r(){return"function"!=typeof u.none?!1:(y?w.length>0&&(t.tbody.find("tr:first").remove(),y=!1):0==w.length&&(t.tbody.html(u.none()),y=!0),!0)}var s=this,t=e.$obj,u=e.$tpl,v=[],w=[],x={},y=!1,z=b.index();this.appendRow=function(){var a=arguments[0],b=arguments[1],c=null;return c=b?q(a,b):p(a),r(),c},this.insertRow=function(a,b){var c=null;return c=z.isIndexDepth(a)?o(a,b):0==w.length&&0==parseInt(a)?this.appendRow(b):n(a,b),r(),c},this.updateRow=function(a,b){var c=this.getRow(a);for(var d in b)c.data[d]=b[d];return c.reload(null,!0),i("reload",c),c},this.moveRow=function(a,c){if(a!=c){var d=this.getRowAll(a),e=d[0],f=b.clone(e.data);if(d.length>1)for(var g=0;g<d.length;g++){var a=z.changeIndex(d[g].index,c,d[0].index);this.insertRow(a,d[g].data)}else this.insertRow(c,f);this.removeRow(e.index)}},this.removeRow=function(a){var b=this.getRow(a);z.isIndexDepth(a)?b.destroy():(b.destroy(),i("remove",w[a]),w.splice(a,1),m(a)),r()},this.openRow=function(a){this.getRow(a).open(),x[a]=!1;for(var b in x)if(x[b]!==!1){var c=this.getRow(x[b]);null!=c&&c.fold()}},this.openRowAll=function(){for(var a=this.getRowAll(),b=0;b<a.length;b++)a[b].isLeaf()||(a[b].open(),x[a[b].index]=!1)},this.foldRow=function(a){this.getRow(a).fold(),x[a]=a},this.foldRowAll=function(){for(var a=this.getRowAll(),b=0;b<a.length;b++)a[b].isLeaf()||(a[b].fold(),x[a[b].index]=a[b].index)},this.removeRows=function(){w=[],r()||t.tbody.html(""),i()},this.sortRows=function(a,c){function d(b){var c=b.data[a];return"string"==typeof c?c.toLowerCase():isNaN(c)||null==c?"":c}var e=b.sort(w);e.setCompare(c?function(a,b){return d(a)>d(b)?!0:!1}:function(a,b){return d(a)<d(b)?!0:!1}),e.run(),t.tbody.html(""),m(function(a){t.tbody.append(w[a].element)})},this.appendColumn=function(b,c){var d=v.length,e=a(u[b]({rows:c})),f=e.filter("thead").find("tr");f.each(function(b){var c=t.thead.find("tr").eq(b);a(this).find("th").each(function(a){c.append(this),f.size()-1==b&&v.push({element:this,list:[]})})});for(var g=0;g<w.length;g++)e.filter("tbody").find("tr").eq(g).find("td").each(function(b){a(w[g].element).append(this),v[d+b].list.push(this),w[g].list.push(this),a.extend(w[g].data,c[g])})},this.removeColumn=function(b){for(var c=0;c<v[b].list.length;c++)a(v[b].element).remove(),a(v[b].list[c]).remove();for(var d=0;d<w.length;d++)w[d].list.splice(b,1);v.splice(b,1)},this.hideColumn=function(a){if("hide"!=v[a].type){for(var b=this.getRowAll(),c=0;c<b.length;c++)b[c].hideCell(a);v[a].hide()}},this.showColumn=function(a){if("show"!=v[a].type){for(var b=this.getRowAll(),c=0;c<b.length;c++)b[c].showCell(a);v[a].show()}},this.getColumnCount=function(){return v.length},this.getRowCount=function(){return w.length},this.getColumn=function(a){return null==a?v:v[a]},this.getRow=function(a){if(null==a)return w;if(z.isIndexDepth(a)){var b=z.getIndexList(a);return l(b,w[b.shift()])}return w[a]?w[a]:null},this.getRowAll=function(a){for(var b=[],c=null==a?w:[this.getRow(a)],d=0;d<c.length;d++)c[d]&&(b.push(c[d]),c[d].children.length>0&&k(b,c[d]));return b},this.getRowParent=function(a){return z.isIndexDepth(a)?this.getRow(z.getParentIndex(a)):null},this.setColumn=function(a,b){v[a]=b},this.setRow=function(a,b){w[a]=b},this.printInfo=function(){console.log(v),console.log(w)},g()};return e}),jui.defineUI("uix.table",["jquery","util.base","ui.dropdown","uix.table.base"],function(a,b,c,d){b.resize(function(){for(var a=jui.get("table"),b=0;b<a.length;b++)for(var c=a[b].list,d=0;d<c.length;d++)c[d].resize()},1e3);var e=function(){function e(a){return"<tr class='expand' style='display: none;'><td id='EXPAND_"+a.timestamp+"'></td></tr>"}function f(a,b){for(var c=[],d=0;d<b.length;d++)if("string"==typeof b[d]){var e=a.getColumn(b[d]);c.push(e.index)}else c.push(b[d]);return c}function g(b){var c=b.options.colshow,d=b.uit.getColumnCount();if(c===!0){b.options.colshow=c=[];for(var e=0;d>e;e++)c.push(e)}else c=f(b,c);for(var e=0;d>e;e++)-1==a.inArray(e,c)?b.uit.hideColumn(e):b.uit.showColumn(e)}function h(b){for(var d=b.listColumn(),e=[],f=0;f<d.length;f++)e.push(a(d[f].element).text());var g=a(b.tpl.menu({columns:e}));a("body").append(g),t=c(g,{close:!1}),a(t.root).find("input[type=checkbox]").each(function(c){"show"==d[c].type?this.checked=!0:this.checked=!1,b.addEvent(this,"click",function(d){var e=a(t.root).find("input[type=checkbox]:checked").size();this.checked?b.showColumn(c,d):e>0?b.hideColumn(c,d):this.checked=!0,b.hideExpand(),b.scroll()})})}function i(c){for(var d=s.table.outerWidth(),e=c.uit.getColumnCount(),f=!1,g=e-1;g>=0;g--){var h=c.getColumn(g),i=a(h.element).outerWidth();"none"==a(h.element).css("display")||f||(i-=b.scrollWidth(),f=!0),a(h.list[0]).outerWidth(i)}s.tbody.outerWidth(d)}function j(b){a(b.root).hasClass("table-scroll")||b.scroll(),s.tbody.off("scroll").scroll(function(a){return s.tbody.scrollTop()+b.options.scrollHeight==s.tbody.get(0).scrollHeight?(b.emit("scroll",a),!1):void 0})}function k(a,b){a.uit.getRowCount()<1||(b&&(a.options.expand&&s.tbody.prepend(e(a)),a.scroll()),a.options.scroll&&j(a),a.setVo())}function l(a,b){for(var b=b?b:a.uit.getRow(),c=0;c<b.length;c++)!function(b){b.children.length>0?(m(a,b),l(a,b.children)):m(a,b)}(b[c])}function m(a,b){a.addEvent(b.element,"click",function(c){if(a.emit("select",[b,c]),a.emit("click",[b,c]),a.options.expand){if(a.options.expandEvent===!1)return;v===b.index?a.hideExpand(c):(null!=v&&a.hideExpand(c),a.showExpand(b.index,void 0,c))}}),a.addEvent(b.element,"dblclick",function(c){a.emit("dblclick",[b,c])}),a.addEvent(b.element,"contextmenu",function(c){return a.emit("rowmenu",[b,c]),!1}),a.options.editRow&&a.options.editEvent&&a.addEvent(b.element,"dblclick",function(c){("TD"==c.target.tagName||"TR"==c.target.tagName)&&a.showEditRow(b.index,c)})}function n(b,c,d,e,g,h){function i(){null!=w&&h()}var j=b.getColumn(e),k=b.options.editRow,l=null;!j.name||k!==!0&&-1==a.inArray(e,f(b,k))?(l=a("<div class='edit'></div>").html(a(c).html()||"&nbsp;"),l.attr("disabled",!0)):l=a("<input type='text' class='edit' />").val(j.name?j.data[d.index]:""),a(c).html(l.css("width","100%")),g&&g.target==c&&l.focus(),b.addEvent(l,"keypress",function(a){13==a.which&&i()}),b.addEvent(s.tbody,"mousedown",function(a){("TD"==a.target.tagName||"TR"==a.target.tagName)&&i()})}function o(a){for(var b=a.options,c=a.uit.getColumnCount(),d=0;c>d;d++){var e=a.getColumn(d);!function(c,d){b.fields&&b.sort&&b.sortEvent===!0||a.addEvent(d.element,"click",function(b){a.emit("colclick",[d,b])}),a.addEvent(d.element,"dblclick",function(b){a.emit("coldblclick",[d,b])}),a.addEvent(d.element,"contextmenu",function(b){return a.emit("colmenu",[d,b]),!1})}(d,e)}}function p(b){for(var c=b.options.sort,d=c===!0?b.uit.getColumnCount():c.length,e=0;d>e;e++){var f=c===!0?e:c[e],g=b.getColumn(f);null!=g.element&&(!function(c,d){b.addEvent(d.element,"click",function(e){a(e.target).hasClass("resize")||(b.sort(c,void 0,e),b.emit("colclick",[d,e]))})}(f,g),a(g.element).css("cursor","pointer"))}}function q(c){function d(b){for(var d=b+1;d<c.uit.getColumnCount();d++){var e=c.getColumn(d).element;if(!a(e).is(":hidden"))return c.getColumn(d)}}function e(c,d){var e=30;if(!(e>j+d||e>k-d)&&(a(h.element).outerWidth(j+d),a(i.element).outerWidth(k-d),c.options.scroll)){var f=a(i.element).outerWidth()-(h.index==c.uit.getColumnCount()-2?b.scrollWidth():0);a(h.list[0]).outerWidth(a(h.element).outerWidth()),a(i.list[0]).outerWidth(f)}}var f=0,g=s.table.offset(),h=null,i=null,j=0,k=0,l=null;s.thead.find(".resize").remove();for(var m=0;m<c.uit.getColumnCount()-1;m++){var n=a(c.getColumn(m).element),o=a("<div class='resize'></div>"),p=n.offset();o.css({position:"absolute",width:"8px",height:n.outerHeight(),left:n.outerWidth()+(p.left-g.left)-1+"px",top:p.top-g.top+"px",cursor:"w-resize","z-index":"1"}),n.append(o),function(b){c.addEvent(o,"mousedown",function(e){return 0==f&&(f=e.pageX),h=c.getColumn(b),i=d(b),j=a(h.element).outerWidth(),k=a(i.element).outerWidth(),l=this,y=!0,!1})}(m)}c.addEvent(document,"mousemove",function(a){f>0&&e(c,a.pageX-f)}),c.addEvent(document,"mouseup",function(b){if(f>0){f=0;var d=a(h.element).offset().left-g.left;return a(l).css("left",a(h.element).outerWidth()+d-1),c.emit("colresize",[h,b]),setTimeout(function(){y=!1},100),!1}})}function r(a,b){a.hideExpand(),a.hideEditRow(),a.unselect(),b||a.uncheckAll()}var s=null,t=null,u=null,v=null,w=null,x={},y=!1;this.init=function(){var b=this.options;if(b.data=null!=b.rows?b.rows:b.data,s={table:a(this.root).css({position:"relative"}),thead:a(this.root).find("thead"),tbody:a(this.root).find("tbody")},this.uit=new d({$obj:s,$tpl:this.tpl},b.fields),b.fields&&b.colshow&&g(this),b.fields&&this.tpl.menu&&h(this),b.resize&&q(this),b.fields&&b.sort&&b.sortEvent===!0&&p(this),b.data.length>0?this.update(b.data):this.setVo(),b.width>0&&s.table.outerWidth(b.width),!b.fields&&(b.sort||b.colshow||b.editRow))throw new Error("JUI_CRITICAL_ERR: 'fields' option is required");o(this)},this.update=function(){var a=1==arguments.length?arguments[0]:arguments[1],b=2==arguments.length?arguments[0]:null;if(null!=b){var c=this.uit.updateRow(b,a);m(this,c),0==parseInt(b)&&this.scroll()}else this.uit.removeRows(),this.scroll(),this.append(a),this.options.sortIndex&&this.sort(this.options.sortIndex,this.options.sortOrder,null)},this.updateTree=function(a){var c=b.index();this.uit.removeRows();for(var d=0;d<a.length;d++){var e=c.getParentIndex(a[d].index);null==e?this.uit.appendRow(a[d].data):this.uit.appendRow(e,a[d].data)}k(this,!0),l(this)},this.append=function(){var a=this.count()>0?!1:!0,b=1==arguments.length?arguments[0]:arguments[1],c=2==arguments.length?arguments[0]:null;b=void 0==b.length?[b]:b;for(var d=0;d<b.length;d++){var e=null;e=null!=c?this.uit.appendRow(c,b[d]):this.uit.appendRow(b[d]),a||m(this,e)}k(this,a),a&&l(this)},this.insert=function(a,b){for(var c=this.count()>0?!1:!0,b=void 0==b.length?[b]:b,d=0;d<b.length;d++)this.uit.insertRow(a,b[d]);k(this,c),l(this)},this.select=function(b){r(this);var c=this.get(b);return a(c.element).parent().find(".selected").removeClass("selected"),a(c.element).addClass("selected"),u=b,c},this.unselect=function(){if(null!=u){var b=this.get(u);return a(b.element).removeClass("selected"),u=null,b}},this.check=function(b){r(this,!0);var c=this.get(b);this.hideExpand(),this.hideEditRow(),this.unselect(),x[b]=c,a(c.element).addClass("checked")},this.uncheck=function(b){if(null!=x[b]){var c=this.get(b);x[b]=null,a(c.element).removeClass("checked")}},this.uncheckAll=function(){x={},s.tbody.find(".checked").removeClass("checked")},this.remove=function(a){return null==a?null:(this.uit.removeRow(a),l(this),void this.scroll())},this.reset=function(){this.uit.removeRows(),this.scroll()},this.move=function(a,b){this.uit.moveRow(a,b),l(this),(0==parseInt(a)||0==parseInt(b))&&this.scroll()},this.sort=function(a,b,c){if(this.options.fields&&this.options.sort&&!y){var d=this.getColumn(a);"string"==typeof d.name&&(d.order=b?b:"asc"==d.order?"desc":"asc",this.uit.setColumn(a,d),this.uit.sortRows(d.name,"desc"==d.order?!0:!1),this.emit("sort",[d,c]),k(this,!0),l(this))}},this.scroll=function(a){if(this.options.scroll){var b=this,c=a&&a>0?a:this.options.scrollHeight,c=c>0?c:200;this.options.scrollHeight=c,s.tbody.css("maxHeight",c+"px"),setTimeout(function(){s.tbody.outerHeight()<c?(s.table.css({"table-layout":""}),s.tbody.css({display:"",overflow:""})):(s.table.css({"table-layout":"fixed"}),s.tbody.css({display:"block",overflow:"auto"})),i(b)},10)}},this.open=function(a){null!=a&&(this.uit.openRow(a),this.emit("open",[this.get(a)]))},this.fold=function(a){null!=a&&(this.uit.foldRow(a),this.emit("fold",[this.get(a)]))},this.openAll=function(){this.uit.openRowAll(),this.emit("openall")},this.foldAll=function(){this.uit.foldRowAll(),this.emit("foldall")},this.resize=function(){this.scroll(),this.options.resize&&q(this)},this.resizeColumns=function(){for(var b=this.listColumn(),c=0;c<b.length;c++)null==b[c].width&&a(b[c].element).outerWidth("auto")},this.size=function(){return this.uit.getRowCount()},this.count=function(){return this.uit.getRowCount()},this.list=function(){return this.uit.getRow()},this.listData=function(){for(var a=this.list(),b=[],c=0;c<a.length;c++)b.push(a[c].data);return b},this.listAll=function(){return this.uit.getRowAll()},this.listChecked=function(){var a=[];for(var b in x)null!=x[b]&&a.push(x[b]);return a},this.listColumn=function(){return this.uit.getColumn()},this.get=function(a){return null==a?null:this.uit.getRow(a)},this.getAll=function(a){return null==a?null:this.uit.getRowAll(a)},this.getColumn=function(b){return null==b?null:this.uit.getColumn("string"==typeof b?a.inArray(b,this.options.fields):b)},this.showColumn=function(a,b){if(this.options.fields){var c=this.getColumn(a);this.uit.showColumn(c.index),this.scroll(),this.resizeColumns(),this.options.resize&&q(this),this.emit("colshow",[c,b])}},this.hideColumn=function(a,b){if(this.options.fields){var c=this.getColumn(a);this.uit.hideColumn(c.index),this.scroll(),this.resizeColumns(),this.options.resize&&q(this),this.emit("colhide",[c,b])}},this.initColumns=function(a){"object"==typeof a&&(this.options.colshow=a,g(this),this.scroll(),this.resizeColumns(),this.options.resize&&q(this))},this.showColumnMenu=function(b){if(this.options.fields&&t){var c=this.listColumn(),d=s.thead.offset();a(t.root).find("input[type=checkbox]").each(function(a){"show"==c[a].type?this.checked=!0:this.checked=!1}),t.move(b,d.top+s.thead.outerHeight()),t.show()}},this.hideColumnMenu=function(){this.options.fields&&t&&t.hide()},this.toggleColumnMenu=function(a){this.options.fields&&t&&("show"==t.type?this.hideColumnMenu():this.showColumnMenu(a))},this.showExpand=function(b,c,d){if(this.options.expand){r(this);var e="#EXPAND_"+this.timestamp,f=this.get(b),c="object"!=typeof c?a.extend({row:f},f.data):c,g=a(e).parent().show();s.tbody.find("tr").removeClass("open"),g.insertAfter(a(f.element).addClass("open")),a(e).attr("colspan",s.thead.find("tr:last > th:visible").size()).html(this.tpl.expand(c)),this.scroll(),this.setVo(),v=b,this.emit("expand",[f,d])}},this.hideExpand=function(b){if(null!=v){var c=this.get(v);a("#EXPAND_"+this.timestamp).parent().hide(),s.tbody.find("tr").removeClass("open"),this.scroll(),v=null,this.emit("expandend",[c,b])}},this.getExpand=function(){return null==v?null:this.get(v)},this.showEditRow=function(b,c){if(this.options.editRow){r(this);var d=this,e=this.get(b),f=a(e.element).find("td");f.each(function(b){n(d,this,e,b,c,function(){var b={},g=e.data;f.each(function(c){var e=d.getColumn(c);if(null!=e.name){var f=a(this).find("input.edit");if(1==f.size()){var g=f.val();b[e.name]=isNaN(g)||null==g||""==g?g:parseFloat(g)}}}),e.data=a.extend(e.data,b);var h=d.emit("editend",[e,c]);h!==!1?d.hideEditRow(b):e.data=g})}),w=b,d.emit("editstart",[e,c])}},this.hideEditRow=function(a){if(null!=w){var b=this.get(w);w=null,this.update(b.index,a?a:b.data)}},this.getEditRow=function(){return null==w?null:this.get(w)},this.setCsv=function(){var a=this.options;if(a.fields||a.csv){var c=1==arguments.length?arguments[0]:arguments[1],d=2==arguments.length?arguments[0]:null,e=b.getCsvFields(a.fields,a.csv),f=a.csvNumber?b.getCsvFields(a.fields,a.csvNumber):null,g=b.csvToData(e,c,f);if(null==d)this.update(g);else{this.reset();for(var h=0;h<g.length;h++){var i=g[h][d];i&&this.insert(i,g[h])}}}},this.setCsvFile=function(){if(this.options.fields||this.options.csv){var a=this,c=1==arguments.length?arguments[0]:arguments[1],d=2==arguments.length?arguments[0]:null;b.fileToCsv(c,function(b){null==d?a.setCsv(b):a.setCsv(d,b)})}},this.getCsv=function(a){if(this.options.fields||this.options.csv){for(var c=b.getCsvFields(this.options.fields,this.options.csv),d=[],e=a?this.listAll():this.list(),f=0;f<e.length;f++)d.push(e[f].data);return b.dataToCsv2({fields:c,rows:d,names:this.options.csvNames})}},this.getCsvBase64=function(a){return this.options.fields||this.options.csv?b.csvToBase64(this.getCsv(a)):void 0},this.downloadCsv=function(a,c){b.typeCheck("string",a)&&(a=a.split(".")[0]);var d=document.createElement("a");d.download=a?a+".csv":"table.csv",d.href=this.getCsvBase64(c),document.body.appendChild(d),d.click(),d.parentNode.removeChild(d)},this.activeIndex=function(){return u||v||w}};return e.setup=function(){return{fields:null,csv:null,csvNames:null,csvNumber:null,data:[],rows:null,colshow:!1,scroll:!1,scrollHeight:200,width:0,expand:!1,expandEvent:!0,editRow:!1,editEvent:!0,resize:!1,sort:!1,sortIndex:null,sortOrder:"asc",sortEvent:!0,animate:!1}},e}),jui.define("uix.tree.node",["jquery"],function(a){var b=function(b,c){function d(a){i.nodenum=isNaN(a)?i.nodenum:a,i.parent&&(null==i.parent.index?i.index=""+i.nodenum:i.index=i.parent.index+"."+i.nodenum),i.parent&&"string"==typeof i.index&&(i.depth=i.index.split(".").length),i.children.length>0&&e(i)}function e(a){for(var b=a.children,c=0;c<b.length;c++)b[c].reload(c),b[c].children.length>0&&e(b[c])}function f(){if(!c)return i.element;try{var b=a(c(a.extend({node:{index:i.index,data:i.data,depth:i.depth}},i.data))).get(0)}catch(d){console.log(d)}return b}function g(b){a(b.element).remove();for(var c=0;c<b.children.length;c++){var d=b.children[c];d.children.length>0?g(d):a(d.element).remove()}}function h(a){for(var b=0;b<a.children.length;b++){var c=a.children[b];c.reload(b),c.children.length>0&&h(c)}}var i=this;this.data=b,this.element=null,this.index=null,this.nodenum=null,this.parent=null,this.children=[],this.depth=0,this.type="open",this.reload=function(b,c){if(d(b),null!=this.element){var e=f();c?a(e).insertAfter(this.element):a(this.parent.element).children("ul").append(e),a(this.element).remove(),this.element=e}else this.element=f()},this.reloadChildrens=function(){h(this)},this.destroy=function(){null!=this.parent?this.parent.removeChild(this.index):(g(this),a(this.element).remove())},this.isLeaf=function(){return 0==this.children.length?!0:!1},this.fold=function(){a(this.element).children("ul").hide(),this.type="fold"},this.open=function(){a(this.element).children("ul").show(),this.type="open"},this.appendChild=function(b){a(this.element).children("ul").append(b.element),this.children.push(b)},this.insertChild=function(b,c){0==b?0==this.children.length?a(this.element).children("ul").append(c.element):a(c.element).insertBefore(this.children[0].element):a(c.element).insertAfter(this.children[b-1].element);var d=this.children.splice(0,b);d.push(c),this.children=d.concat(this.children),h(this)},this.removeChild=function(a){for(var b=0;b<this.children.length;b++){var c=this.children[b];c.index==a&&(this.children.splice(b,1),g(c))}h(this)},this.lastChild=function(){return this.children.length>0?this.children[this.children.length-1]:null},this.lastChildLeaf=function(a){var b=a?a:this.lastChild();return b.isLeaf()?b:this.lastChildLeaf(b.lastChild())}};return b}),jui.define("uix.tree.base",["jquery","util.base","uix.tree.node"],function(a,b,c){var d=function(a){function d(a,b,d){var e=new c(a,n.node);return e.parent=d?d:null,e.reload(b),e}function e(a,b){var c=b.children;if(c.length>0)for(var d=0;d<c.length;d++)a.push(c[d]),c[d].children.length>0&&e(a,c[d])}function f(a,b){if(!b)return null;var c=a.shift();return void 0==c?b:f(a,b.children[c])}function g(a,b){var c=o.getIndexList(a),e=k.getNodeParent(a),f=c[c.length-1];return node=d(b,f,e),e.insertChild(f,node),node}function h(a){if(null==l)l=d(a),m.tree.append(l.element);else{var b=d(a,l.children.length,l);l.appendChild(b)}return b}function i(a,b){var c=k.getNode(a),e=d(b,c.children.length,c);return c.appendChild(e),e}function j(a,b){for(var c=[];;){var d=b.parent;if(!d)break;c.push(d),b=d}for(var e=0;e<c.length;e++)if(a==c[e])return!0;return!1}var k=this,l=null,m=a.$obj,n=a.$tpl,o=b.index();this.appendNode=function(){var a=arguments[0],b=arguments[1];return b?i(a,b):h(a)},this.insertNode=function(a,b){return 0==l.children.length&&0==parseInt(a)?this.appendNode(b):g(a,b)},this.updateNode=function(a,b){var c=this.getNode(a);for(var d in b)c.data[d]=b[d];return c.reload(c.nodenum,!0),c.reloadChildrens(),c},this.removeNode=function(a){this.getNode(a).destroy()},this.removeNodes=function(){var a=l.children;if(a.length>0){var b=a.pop();b.parent=null,b.destroy(),this.removeNodes()}},this.openNode=function(a){null==a?this.getRoot().open():this.getNode(a).open()},this.foldNode=function(a){null==a?this.getRoot().fold():this.getNode(a).fold()},this.openNodeAll=function(a){for(var b=this.getNodeAll(a),c=0;c<b.length;c++)b[c].open();null==a&&this.getRoot().open()},this.foldNodeAll=function(a){for(var b=this.getNodeAll(a),c=0;c<b.length;c++)b[c].fold();null==a&&this.getRoot().fold()},this.moveNode=function(a,b){if(a!=b){var c=this.getNode(a),d=this.getNodeParent(b),e=o.getIndexList(b);if(tNo=e[e.length-1],!j(c,d)){c.parent.children.splice(c.nodenum,1),c.parent.reloadChildrens(),c.parent=d;var f=d.children.splice(0,tNo);f.push(c),d.children=f.concat(d.children),d.reloadChildrens()}}},this.getNode=function(a){if(null==a)return l.children;var b=l.children;if(o.isIndexDepth(a)){var c=o.getIndexList(a);return f(c,b[c.shift()])}return b[a]?b[a]:null},this.getNodeAll=function(a){for(var b=[],c=null==a?l.children:[this.getNode(a)],d=0;d<c.length;d++)c[d]&&(b.push(c[d]),c[d].children.length>0&&e(b,c[d]));return b},this.getNodeParent=function(a){var b=o.getIndexList(a);return 1==b.length?l:2==b.length?this.getNode(b[0]):b.length>2?(b.pop(),this.getNode(b.join("."))):void 0},this.getRoot=function(){return l}};return d}),jui.defineUI("uix.tree",["util.base","uix.tree.base"],function(a,b){var c=function(){function c(a,b){for(var c=0;c<b.length;c++){var d=b[c];$(d.element).removeClass("open fold leaf last"),d.parent&&d.isLeaf()?$(d.element).addClass("leaf"):"open"==d.type?($(d.element).addClass("open"),d.open()):($(d.element).addClass("fold"),d.fold()),d.parent?d.parent.lastChild()==d&&$(d.element).addClass("last"):$(d.element).addClass("root"),$(d.element).children("i:first-child").remove(),$(d.element).prepend($("<i></i>"))}}function d(a,b,c){if(null==b)if(a.options.rootHide){for(var d=a.uit.getRoot().children,e=0;e<d.length;e++)c(d[e].index);j(a,!1)}else c(b),j(a,!0);else c(b),j(a,!1)}function e(a,b){for(var c=0;c<b.length;c++)!function(b){var c=$(b.element);a.addEvent(c.children("i:first-child"),"click",function(c){"open"==b.type?a.fold(b.index,c):a.open(b.index,c),c.stopPropagation()}),a.addEvent(c.children("a,span,div")[0],"click",function(c){a.emit("select",[b,c]),c.stopPropagation()})}(b[c])}function f(a,b){if(a.options.drag){var c=a.uit.getRoot();$("body").off("mousemove").off("mouseup");for(var d=0;d<b.length;d++)!function(b){$(b.element).off("mousedown").off("mouseup"),a.addEvent(b.element,"mousedown",function(c){return"I"!=c.target.tagName?(null==k.start&&(k.start=b.index,a.emit("dragstart",[b.index,c])),!1):void 0}),a.addEvent(b.element,"mouseup",function(c){if("I"!=c.target.tagName){if(a.options.dragChild!==!1&&k.start&&k.start!=b.index){var d=b.lastChild(),e=d?m.getNextIndex(d.index):b.index+".0";a.move(k.start,e),a.emit("dragend",[e,c])}return k.start=null,k.end=null,!1}}),a.addEvent(c.element,"mouseup",function(b){if("I"!=b.target.tagName){if(a.options.dragChild!==!1&&k.start){var d=""+c.children.length;a.move(k.start,d),a.emit("dragend",[d,b])}return k.start=null,k.end=null,!1}})}(b[d]);a.addEvent("body","mouseup",function(b){return k.start&&k.end&&(a.move(k.start,k.end),a.emit("dragend",[k.end,b])),k.start=null,k.end=null,!1})}}function g(a){if(a.options.drag){$(a.root).find(".drag").remove();for(var b=a.listAll(),c=0;c<b.length;c++){var d=b[c],e=$(d.element).position();e.top>0&&i(a,d,e)}}}function h(a){if(a.options.drag)for(var b=a.listAll(),c=0;c<b.length;c++){var d=b[c],e=$(d.element).position();e.top>0&&d.parent&&d.parent.lastChild()==d&&(e.top=e.top+$(d.element).outerHeight(),i(a,d,e,!0))}}function i(a,b,c,d){if(a.options.drag){var e=d?m.getNextIndex(b.index):b.index,f=$("<div class='drag'></div>").attr("data-index",e).css(c).outerWidth($(b.element).outerWidth());$(a.root).append(f),a.addEvent(f,"mouseover",function(a){k.start&&(k.end=e,f.addClass("on"))}),a.addEvent(f,"mouseout",function(a){k.start&&f.removeClass("on")})}}function j(a,b){var d=a.listAll();c(a,d),e(a,d),f(a,d),g(a),h(a),b&&(c(a,[a.uit.getRoot()]),e(a,[a.uit.getRoot()]))}var k={start:null,end:null},l=null,m=a.index();this.init=function(){var a=this.options;if(this.uit=new b({$obj:{tree:$(this.root)},$tpl:this.tpl}),!a.root)throw new Error("JUI_CRITICAL_ERROR: root data is required");if(this.uit.appendNode(a.root),j(this,!0),a.rootHide){var c=this.uit.getRoot();$(c.element).css("padding-left","0px"),$(c.element).children("*:not(ul)").hide()}a.rootFold&&this.fold()},this.update=function(b,c){var d=1==arguments.length?arguments[0]:arguments[1],b=2==arguments.length?arguments[0]:null;if(null!=b)this.uit.updateNode(b,d);else{var e=a.index();this.uit.removeNodes();for(var f=0;f<d.length;f++){var g=e.getParentIndex(d[f].index);null==g?this.uit.appendNode(d[f].data):this.uit.appendNode(g,d[f].data)}}j(this)},this.append=function(){var a=1==arguments.length?arguments[0]:arguments[1],b=2==arguments.length?arguments[0]:null;a=void 0==a.length?[a]:a;for(var c=0;c<a.length;c++)null!=b?this.uit.appendNode(b,a[c]):this.uit.appendNode(a[c]);j(this)},this.insert=function(a,b){for(var c=void 0==b.length?[b]:b,d=0;d<c.length;d++)this.uit.insertNode(a,c[d]);j(this)},this.select=function(a){var b=null==a?this.uit.getRoot():this.get(a);return $(this.root).find("li").removeClass("active"),$(b.element).addClass("active"),l=a,b},this.unselect=function(){if(null!=l){var a=this.get(l);return $(a.element).removeClass("active"),l=null,a}},this.remove=function(a){this.uit.removeNode(a),j(this)},this.reset=function(){this.uit.removeNodes(),j(this)},this.move=function(a,b){this.uit.moveNode(a,b),j(this)},this.open=function(a,b){if(null!=a||!this.options.rootHide){var c=null==a;this.uit.openNode(a),j(this,c),this.emit("open",[c?this.uit.getRoot():this.get(a),b])}},this.fold=function(a,b){if(null!=a||!this.options.rootHide){var c=null==a;this.uit.foldNode(a),j(this,c),this.emit("fold",[c?this.uit.getRoot():this.get(a),b])}},this.openAll=function(a){var b=this,c=null==a;d(this,a,function(a){b.uit.openNodeAll(a)}),this.emit("openall",[c?this.uit.getRoot():this.get(a)])},this.foldAll=function(a){var b=this,c=null==a;d(this,a,function(a){b.uit.foldNodeAll(a)}),this.emit("foldall",[c?this.uit.getRoot():this.get(a)])},this.list=function(){return this.uit.getNode()},this.listAll=function(){return this.uit.getNodeAll()},this.listParents=function(a){function b(a){null!=a.index&&(d.push(a),null!=a.parent&&b(a.parent))}var c=this.get(a),d=[];return c.parent&&b(c.parent),d.reverse()},this.get=function(a){return null==a?null:this.uit.getNode(a)},this.getAll=function(a){return null==a?null:this.uit.getNodeAll(a)},this.activeIndex=function(){return l}};return c.setup=function(){return{root:null,rootHide:!1,rootFold:!1,drag:!1,dragChild:!0}},c}),jui.defineUI("uix.xtable",["jquery","util.base","ui.modal","uix.table"],function(a,b,c,d){b.resize(function(){for(var a=jui.get("uix.xtable"),b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.length;d++)c[d].resize()},1e3);var e=function(){function e(b){function c(b,c){var d={};for(var e in b.options)-1==a.inArray(e,c)&&(d[e]=b.options[e]);return b.options.scrollWidth>0&&(d.resize=!1),d}function e(b,c,d){var e=b.options;e.scrollWidth>0?b.scrollWidth(e.scrollWidth,!0):e.width>0&&a(b.root).outerWidth(e.width)}function f(b,c){a(c.root).wrap("<div class='head'></div>"),a(c.root).children("tbody").remove()}function g(b,c){var d=c.listColumn();"page"!=b.options.buffer?(a(c.root).wrap("<div class='body' style='max-height: "+b.options.scrollHeight+"px'></div>"),a(c.root).parent().css({"overflow-y":"scroll"})):a(c.root).wrap("<div class='body'></div>"),a(c.root).find("thead > tr").outerHeight(0).not(":last-child").remove();for(var e=0;e<d.length;e++)a(d[e].element).html("").outerHeight(0)}var h=["buffer","bufferCount","csvCount","sortLoading","sortCache","sortIndex","sortOrder","event","rows","scrollWidth","width"],i=a(b.root);i.append(i.children("table").clone()),k=d(i.children("table:first-child"),c(b,h)),f(b,k),l=d(i.children("table:last-child"),c(b,h.concat("resize"))),g(b,l),e(b,k,l)}function f(c){k.on("colresize",function(d,e){for(var f=k.listColumn(),g=l.listColumn(),h=!1,i=f.length-1;i>=0;i--){var m=a(f[i].element).outerWidth();"page"==c.options.buffer||"show"!=f[i].type||h?(a(f[i].element).outerWidth(m),a(g[i].element).outerWidth(m)):(b.browser.msie?a(g[i].element).outerWidth(m-j(c)):a(g[i].element).css({width:"auto"}),h=!0)}c.emit("colresize",[d,e]);
}),k.on("colshow",function(a,b){l.uit.showColumn(a.index),c.resize(),c.emit("colshow",[a,b])}),k.on("colhide",function(a,b){l.uit.hideColumn(a.index),c.resize(),c.emit("colhide",[a,b])}),k.on("colclick",function(a,b){c.emit("colclick",[a,b])}),k.on("coldblclick",function(a,b){c.emit("coldblclick",[a,b])}),k.on("colmenu",function(a,b){c.emit("colmenu",[a,b])}),k.on("sort",function(a,b){c.sort(a.index,a.order,b),c.emit("sort",[a,b]),c.options.sortCache&&c.setOption({sortIndex:a.index,sortOrder:a.order})}),l.on("select",function(a,b){c.emit("select",[a,b])}),l.on("click",function(a,b){c.emit("click",[a,b])}),l.on("dblclick",function(a,b){c.emit("dblclick",[a,b])}),l.on("rowmenu",function(a,b){c.emit("rowmenu",[a,b])}),l.on("expand",function(a,b){c.emit("expand",[a,b])}),l.on("expandend",function(a,b){c.emit("expandend",[a,b])})}function g(b,c,d){var e=b.options,f=a(b.root).children(".head"),g=a(b.root).children(".body");g.off("scroll").scroll(function(a){return b.hideColumnMenu(),c>0&&f.scrollLeft(this.scrollLeft),"scroll"==e.buffer&&this.scrollTop+d>=g.get(0).scrollHeight&&(b.next(),b.emit("scroll",a)),!1})}function h(b){function c(b){var c=30;e.head+b<e["max-width"]||e.column+b<c||(a(d.head.element).outerWidth(e.column+b),a(d.body.element).outerWidth(e.column+b),a(k.root).outerWidth(e.head+b),a(l.root).outerWidth(e.body+b))}var d={},e={},f=0;a(b.root).find("thead .resize").remove();for(var g=0,h=k.uit.getColumnCount();h>g;g++){var j=a(k.getColumn(g).element),m=a("<div class='resize'></div>"),n=j.position(),o=j.outerWidth()+n.left-1;m.css({position:"absolute",width:s+"px",height:j.outerHeight(),left:(g==h-1?o-s:o)+"px",top:n.top+"px",cursor:"w-resize","z-index":"1"}),j.append(m),function(c,g){b.addEvent(m,"mousedown",function(b){return 0==f&&(f=b.pageX),d={head:k.getColumn(c),body:l.getColumn(c),isLast:g},e={column:a(d.head.element).outerWidth(),head:a(k.root).outerWidth(),body:a(l.root).outerWidth(),"max-width":parseInt(a(k.root).parent().css("max-width"))},r=!0,!1})}(g,g==h-1)}b.addEvent(document,"mousemove",function(a){f>0&&c(a.pageX-f)}),b.addEvent(document,"mouseup",function(b){if(f>0){if(d.isLast){var c=a(l.root).parent().scrollLeft(),e=b.pageX-f;e>0&&(a(k.root).parent().scrollLeft(c+e),a(l.root).parent().scrollLeft(c+e))}return f=0,i(500),k.emit("colresize",[d.head,b]),setTimeout(function(){r=!1},100),!1}}),k.on("colshow",i),k.on("colhide",i)}function i(b){setTimeout(function(){for(var b=0,c=k.uit.getColumnCount();c>b;b++){var d=a(k.getColumn(b).element),e=d.position(),f=d.outerWidth()+e.left-1;d.find(".resize").css("left",(b==c-1?f-s:f)+"px")}},b)}function j(a){return"page"==a.options.buffer?0:b.scrollWidth()+1}var k=null,l=null,m=[],n=null,o=null,p=1,q=!1,r=!1,s=8;this.init=function(){var b=this.options;if(b.data=null!=b.rows?b.rows:b.data,"TABLE"==this.root.tagName){var d=a(this.root).wrap("<div class='xtable'></div>");this.root=d.parent().get(0)}if(e(this),f(this),g(this,b.scrollWidth,b.scrollHeight),b.data&&this.update(b.data),b.tpl.loading){var i=a(b.tpl.loading);a(this.root).append(i),o=c(i,{target:this.selector,opacity:.1,autoHide:!1}),b.sortLoading=b.sortLoading===!0?500:b.sortLoading}b.resize&&(b.scrollWidth>0?h(this):(k.resizeColumns(),k.resize()))},this.select=function(a){return l.select(a)},this.update=function(a){m=a,this.clear(),this.next(),this.emit("update"),k.emit("colresize"),this.options.sortIndex&&this.sort(this.options.sortIndex,this.options.sortOrder,void 0,!0)},this.next=function(){var a=(p-1)*this.options.bufferCount,b=a+this.options.bufferCount;if(b=b>m.length?m.length:b,b<=m.length){for(var c=[],d=a;b>d;d++)c.push(m[d]);l.append(c),this.emit("next",[p]),c.length>0&&p++}},this.page=function(a){return"scroll"==this.options.buffer?!1:this.getPage()==a?!1:(this.clear(),p=1>a?1:a,void this.next())},this.sort=function(a,c,d,e){function f(){var a=b.sort(m);a.setCompare("desc"==i.order?function(a,b){return g(a)>g(b)?!0:!1}:function(a,b){return g(a)<g(b)?!0:!1}),a.run(),h.emit("sortend",[i,d]),h.clear(),h.next(),h.hideLoading()}function g(a){var b=a[i.name];return"string"==typeof b?b.toLowerCase():isNaN(b)||null==b?"":b}if(this.options.fields&&this.options.sort&&!r){var h=this,i=k.getColumn(a);"string"==typeof i.name&&(i.order=c?c:"asc"==i.order?"desc":"asc",k.uit.setColumn(a,i),this.options.sortLoading&&!e?(h.showLoading(),setTimeout(function(){f()},this.options.sortLoading)):f())}},this.filter=function(a){if("function"==typeof a){null==n?n=m:m=n;for(var b=m.slice(),c=[],d=0,e=b.length;e>d;d++)a(b[d])===!0&&c.push(b[d]);this.update(c),this.emit("filter",[c])}},this.rollback=function(){null!=n&&(this.update(n),n=null)},this.clear=function(){p=1,l.uit.removeRows(),l.scroll()},this.reset=function(){this.clear(),m=[]},this.resize=function(){k.resizeColumns(),k.resize(),k.emit("colresize")},this.scrollWidth=function(b,c){if(0!=this.options.scrollWidth){var d=this.options.width;if(d>0){var e=b>=d?b-j(this):d;a(this.root).outerWidth(e)}else a(this.root).outerWidth(b-j(this));if(b>0){var f=a(this.root).outerWidth();a(this.root).outerWidth(b),c&&(a(k.root).outerWidth(f+j(this)),a(l.root).outerWidth(f),i(1e3)),a(k.root).parent().css("max-width",b),a(l.root).parent().css("max-width",b)}}},this.scrollHeight=function(b){"page"!=this.options.buffer&&(a(this.root).find(".body").css("max-height",b+"px"),g(this,this.options.scrollWidth,b))},this.height=function(a){this.scrollHeight(a)},this.size=function(){return m.length},this.count=function(){return m.length},this.list=function(){return l.list()},this.listColumn=function(){return k.listColumn()},this.listData=function(){return m},this.get=function(a){return null==a?null:l.get(a)},this.getColumn=function(a){return k.getColumn(a)},this.getData=function(a){return m[a]},this.showColumn=function(a){k.showColumn(a)},this.hideColumn=function(a){k.hideColumn(a)},this.initColumns=function(a){k.initColumns(a),l.initColumns(a),k.emit("colresize")},this.showColumnMenu=function(a){k.showColumnMenu(a)},this.hideColumnMenu=function(){k.hideColumnMenu()},this.toggleColumnMenu=function(a){k.toggleColumnMenu(a)},this.showExpand=function(a,b){l.showExpand(a,b)},this.hideExpand=function(a){a?l.hideExpand(a):l.hideExpand()},this.getExpand=function(){return l.getExpand()},this.showLoading=function(a){if(o&&!q&&(o.show(),q=!0,a>0)){var b=this;setTimeout(function(){b.hideLoading()},a)}},this.hideLoading=function(){o&&q&&(o.hide(),q=!1)},this.setCsv=function(a){var c=this.options;if(c.fields||c.csv){var d=b.getCsvFields(c.fields,c.csv),e=c.csvNumber?b.getCsvFields(c.fields,c.csvNumber):null;this.update(b.csvToData(d,a,e))}},this.setCsvFile=function(a){if(this.options.fields||this.options.csv){var c=this;b.fileToCsv(a,function(a){c.setCsv(a)})}},this.getCsv=function(){if(this.options.fields||this.options.csv){var a=b.getCsvFields(this.options.fields,this.options.csv),c=m.length>this.options.csvCount?this.options.csvCount:m.length;return b.dataToCsv2({fields:a,rows:m,count:c,names:this.options.csvNames})}},this.getCsvBase64=function(){return this.options.fields||this.options.csv?b.csvToBase64(this.getCsv()):void 0},this.downloadCsv=function(a){b.typeCheck("string",a)&&(a=a.split(".")[0]);var c=document.createElement("a");c.download=a?a+".csv":"table.csv",c.href=this.getCsvBase64(),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c)},this.rowFunc=function(a,b,c){if(this.options.fields){var d="function"==typeof c?!0:!1,e=0,f=d?0:m.length,g=k.getColumn(b);if(g.name)for(var h=0;h<m.length;h++){var i=m[h][g.name];isNaN(i)||(d?c(m[h])&&(e+=i,f++):e+=i)}return"sum"==a?e:"avg"==a?e/f:null}},this.getPage=function(){return p-1},this.activeIndex=function(){return l.activeIndex()}};return e.setup=function(){return{fields:null,csv:null,csvNames:null,csvNumber:null,csvCount:1e4,data:[],rows:null,colshow:!1,expand:!1,expandEvent:!0,resize:!1,scrollHeight:200,scrollWidth:0,width:0,buffer:"scroll",bufferCount:100,sort:!1,sortLoading:!1,sortCache:!1,sortIndex:null,sortOrder:"asc",sortEvent:!0,animate:!1}},e});